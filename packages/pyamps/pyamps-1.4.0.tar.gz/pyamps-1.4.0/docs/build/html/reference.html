
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>API Reference &#8212; pyAMPS 1.0.0 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Coefficient file format" href="model_coefficients.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="model_coefficients.html" title="Coefficient file format"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyAMPS 1.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h1>
<p>To learn how to quickly get started with pyAMPS, we recommend that people start looking at <a class="reference internal" href="usage.html#usage"><span class="std std-ref">Usage</span></a>, and use this page once a comprehensive listing of all functionality is needed. Documentation for each function and its arguments can be found using the <cite>help</cite> command.</p>
<div class="section" id="module-pyamps">
<span id="core-functionality-pyamps"></span><h2>Core functionality (<cite>pyamps</cite>)<a class="headerlink" href="#module-pyamps" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyamps.AMPS">
<em class="property">class </em><code class="descclassname">pyamps.</code><code class="descname">AMPS</code><span class="sig-paren">(</span><em>v</em>, <em>By</em>, <em>Bz</em>, <em>tilt</em>, <em>F107</em>, <em>minlat=60</em>, <em>maxlat=89.99</em>, <em>height=110.0</em>, <em>dr=2</em>, <em>M0=4</em>, <em>resolution=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate and plot maps of the model Average Magnetic field and Polar current System (AMPS)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>v</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – solar wind velocity in km/s</li>
<li><strong>By</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – IMF GSM y component in nT</li>
<li><strong>Bz</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – IMF GSM z component in nT</li>
<li><strong>tilt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – dipole tilt angle in degrees</li>
<li><strong>F107</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – F10.7 index in s.f.u.</li>
<li><strong>minlat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) – low latitude boundary of grids  (default 60)</li>
<li><strong>maxlat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) – low latitude boundary of grids  (default 89.99)</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) – altitude of the ionospheric currents in km (default 110)</li>
<li><strong>dr</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) – latitudinal spacing between equal area grid points (default 2 degrees)</li>
<li><strong>M0</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) – number of grid points in the most poleward circle of equal area grid points (default 4)</li>
<li><strong>resolution</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) – resolution in both directions of the scalar field grids (default 100)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># initialize by supplying a set of external conditions:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">AMPS</span><span class="p">(</span><span class="n">solar_wind_velocity_in_km_per_s</span><span class="p">,</span>
<span class="go">             IMF_By_in_nT, IMF_Bz_in_nT,</span>
<span class="go">             dipole_tilt_in_deg,</span>
<span class="go">             F107_index)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># make summary plot:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">plot_currents</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># calculate field-aligned currents on a pre-defined grid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ju</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_upward_current</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Ju will be evaluated at the following coords:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlat</span><span class="p">,</span> <span class="n">mlt</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">scalargrid</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># It is also possible to specify coordinates (can be slow with</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># repeated calls)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ju</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_upward_current</span><span class="p">(</span><span class="n">mlat</span> <span class="o">=</span> <span class="n">my_mlats</span><span class="p">,</span> <span class="n">mlt</span> <span class="o">=</span> <span class="n">my_mlts</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># get components of the total height-integrated horizontal current,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># calculated on a pre-defined grid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j_east</span><span class="p">,</span> <span class="n">j_north</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_total_current</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># j_east, and j_north will be evaluated at the following coords</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># (default grids are different with vector quantities)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlat</span><span class="p">,</span> <span class="n">mlt</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">vectorgrid</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># update model vectors (tor_c, tor_s, etc.) without</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># recalculating the other matrices:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">update_model</span><span class="p">(</span><span class="n">new_v</span><span class="p">,</span> <span class="n">new_By</span><span class="p">,</span> <span class="n">new_Bz</span><span class="p">,</span> <span class="n">new_tilt</span><span class="p">,</span> <span class="n">new_F107</span><span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="pyamps.AMPS.tor_c">
<code class="descname">tor_c</code><a class="headerlink" href="#pyamps.AMPS.tor_c" title="Permalink to this definition">¶</a></dt>
<dd><p><em>numpy.ndarray</em> – vector of cos term coefficents in the toroidal field expansion</p>
</dd></dl>

<dl class="attribute">
<dt id="pyamps.AMPS.tor_s">
<code class="descname">tor_s</code><a class="headerlink" href="#pyamps.AMPS.tor_s" title="Permalink to this definition">¶</a></dt>
<dd><p><em>numpy.ndarray</em> – vector of sin term coefficents in the toroidal field expansion</p>
</dd></dl>

<dl class="attribute">
<dt id="pyamps.AMPS.pol_c">
<code class="descname">pol_c</code><a class="headerlink" href="#pyamps.AMPS.pol_c" title="Permalink to this definition">¶</a></dt>
<dd><p><em>numpy.ndarray</em> – vector of cos term coefficents in the poloidal field expansion</p>
</dd></dl>

<dl class="attribute">
<dt id="pyamps.AMPS.pol_s">
<code class="descname">pol_s</code><a class="headerlink" href="#pyamps.AMPS.pol_s" title="Permalink to this definition">¶</a></dt>
<dd><p><em>numpy.ndarray</em> – vector of sin term coefficents in the poloidal field expansion</p>
</dd></dl>

<dl class="attribute">
<dt id="pyamps.AMPS.keys_P">
<code class="descname">keys_P</code><a class="headerlink" href="#pyamps.AMPS.keys_P" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> – list of spherical harmonic wave number pairs (n,m) corresponding to elements of pol_c and pol_s</p>
</dd></dl>

<dl class="attribute">
<dt id="pyamps.AMPS.keys_T">
<code class="descname">keys_T</code><a class="headerlink" href="#pyamps.AMPS.keys_T" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> – list of spherical harmonic wave number pairs (n,m) corresponding to elements of tor_c and tor_s</p>
</dd></dl>

<dl class="attribute">
<dt id="pyamps.AMPS.vectorgrid">
<code class="descname">vectorgrid</code><a class="headerlink" href="#pyamps.AMPS.vectorgrid" title="Permalink to this definition">¶</a></dt>
<dd><p><em>tuple</em> – grid used to calculate and plot vector fields</p>
</dd></dl>

<dl class="attribute">
<dt id="pyamps.AMPS.scalargrid">
<code class="descname">scalargrid</code><a class="headerlink" href="#pyamps.AMPS.scalargrid" title="Permalink to this definition">¶</a></dt>
<dd><p><em>tuple</em> – grid used to calculate and plot scalar fields</p>
<p>The grid formats are as follows (see also example below):
(np.hstack((mlat_north, mlat_south)), np.hstack((mlt_north, mlt_south)))</p>
<p>The grids can be changed directly, but member function calculate_matrices()
must then be called for the change to take effect.</p>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.calculate_matrices">
<code class="descname">calculate_matrices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.calculate_matrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.calculate_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the matrices that are needed to calculate currents and potentials</p>
<p>Call this function if and only if the grid has been changed manually</p>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.get_AE_indices">
<code class="descname">get_AE_indices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.get_AE_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.get_AE_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate model synthetic auroral electrojet (AE) indices: AL and AU. The unit is nT</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Here, AL and AU are defined as the lower/upper envelope curves for the northward component
of the ground magnetic field perturbation that is equivalent with the divergence-free current,
evaluated on <cite>scalargrid</cite>. Thus all the caveats for the <cite>get_ground_perturbation()</cite> function
applies to these calculations as well. An additional caveat is that we have in principle
perfect coverage with the model, while the true AE indices are derived using a small set of
magnetometers in the auroral zone. The model values are also based on QD northward component,
instead of the “H component”, which is used in the official measured AL index. It is possible
to calculate model AE indices that are more directly comparable to the measured indices.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>AL_n</strong> (<em>float</em>) – Model AL index in the northerm hemisphere</li>
<li><strong>AL_s</strong> (<em>float</em>) – Model AL index in the southern hemisphere</li>
<li><strong>AU_n</strong> (<em>float</em>) – Model AU index in the northerm hemisphere</li>
<li><strong>AU_s</strong> (<em>float</em>) – Model AU index in the southern hemisphere</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.get_curl_free_current">
<code class="descname">get_curl_free_current</code><span class="sig-paren">(</span><em>mlat=&lt;object object&gt;</em>, <em>mlt=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.get_curl_free_current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.get_curl_free_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the curl-free part of the horizontal current, in units of mA/m.
The calculations refer to the height chosen upon initialization of the AMPS
object (default 110 km).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mlat</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlats at which to calculate the current. Will be ignored if mlt is not also specified. If
not specified, the calculations will be done using the coords of the <cite>vectorgrid</cite> attribute.</li>
<li><strong>mlt</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlts at which to calculate the current. Will be ignored if mlat is not also specified. If
not specified, the calculations will be done using the coords of the <cite>vectorgrid</cite> attribute.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>jcf_eastward</strong> (<em>numpy.ndarray, float</em>) – eastward component of the curl-free current evalulated at the coordinates given by the <cite>vectorgrid</cite> attribute</li>
<li><strong>jcf_northward</strong> (<em>numpy.ndarray, float</em>) – northward component of the curl-free current evalulated at the coordinates given by the <cite>vectorgrid</cite> attribute</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#pyamps.AMPS.get_divergence_free_current" title="pyamps.AMPS.get_divergence_free_current"><code class="xref py py-meth docutils literal"><span class="pre">get_divergence_free_current()</span></code></a></dt>
<dd>Calculate divergence-free part of the horizontal current</dd>
<dt><a class="reference internal" href="#pyamps.AMPS.get_total_current" title="pyamps.AMPS.get_total_current"><code class="xref py py-meth docutils literal"><span class="pre">get_total_current()</span></code></a></dt>
<dd>Calculate total horizontal current</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.get_curl_free_current_potential">
<code class="descname">get_curl_free_current_potential</code><span class="sig-paren">(</span><em>mlat=&lt;object object&gt;</em>, <em>mlt=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.get_curl_free_current_potential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.get_curl_free_current_potential" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the curl-free current potential (unit is kA). The curl-free
current potential is a scalar alpha which relates to the curl-free part
of the horizontal current by J_{cf} = grad(alpha). The calculations
refer to the height chosen upon initialization of the AMPS object (default
110 km).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mlat</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlats at which to calculate the current. Will be ignored if mlt is not also specified. If
not specified, the calculations will be done using the coords of the <cite>scalargrid</cite> attribute.</li>
<li><strong>mlt</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlts at which to calculate the current. Will be ignored if mlat is not also specified. If
not specified, the calculations will be done using the coords of the <cite>scalargrid</cite> attribute.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>alpha</strong> – Curl-free current potential evaulated at self.scalargrid, or, if specified, mlat/mlt</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.get_divergence_free_current">
<code class="descname">get_divergence_free_current</code><span class="sig-paren">(</span><em>mlat=&lt;object object&gt;</em>, <em>mlt=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.get_divergence_free_current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.get_divergence_free_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the divergence-free part of the horizontal current, in units of mA/m.
The calculations refer to the height chosen upon initialization of the AMPS
object (default 110 km).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mlat</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlats at which to calculate the current. Will be ignored if mlt is not also specified. If
not specified, the calculations will be done using the coords of the <cite>vectorgrid</cite> attribute.</li>
<li><strong>mlt</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlts at which to calculate the current. Will be ignored if mlat is not also specified. If
not specified, the calculations will be done using the coords of the <cite>vectorgrid</cite> attribute.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>jdf_eastward</strong> (<em>numpy.ndarray, float</em>) – eastward component of the divergence-free current evalulated at the coordinates given by the <cite>vectorgrid</cite> attribute</li>
<li><strong>jdf_northward</strong> (<em>numpy.ndarray, float</em>) – northward component of the divergence-free current evalulated at the coordinates given by the <cite>vectorgrid</cite> attribute</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#pyamps.AMPS.get_curl_free_current" title="pyamps.AMPS.get_curl_free_current"><code class="xref py py-meth docutils literal"><span class="pre">get_curl_free_current()</span></code></a></dt>
<dd>Calculate curl-free part of the current</dd>
<dt><a class="reference internal" href="#pyamps.AMPS.get_total_current" title="pyamps.AMPS.get_total_current"><code class="xref py py-meth docutils literal"><span class="pre">get_total_current()</span></code></a></dt>
<dd>Calculate total horizontal current</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.get_divergence_free_current_function">
<code class="descname">get_divergence_free_current_function</code><span class="sig-paren">(</span><em>mlat=&lt;object object&gt;</em>, <em>mlt=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.get_divergence_free_current_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.get_divergence_free_current_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the divergence-free current function</p>
<p>Isocontours of the divergence-free current function indicates the alignment of the
divergence-free part of the horizontal current. Its direction is given by the cross
product between a vertical vector and the gradient of the divergence-free current function.
A fixed amount of current flows between isocontours. The calculations refer to
the height chosen upon initialization of the AMPS object (default 110 km). Divergence-free
current function unit is kA.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The divergence-free current is similar to what is often termed the <cite>equivalent current</cite>, that
is derived from ground based magnetic field measurements. However, the present divergence-free
current is derived from measurements above the ionosphere, and thus it contains signal both from
ionospheric currents below low Earth orbit, and from subsurface induced currents.
See Laundal et al. (2016) <a class="footnote-reference" href="#id2" id="id1">[1]</a> where this current is called
<cite>Psi</cite> for more detail.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mlat</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlats at which to calculate the current. Will be ignored if mlt is not also specified. If
not specified, the calculations will be done using the coords of the <cite>scalargrid</cite> attribute.</li>
<li><strong>mlt</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlts at which to calculate the current. Will be ignored if mlat is not also specified. If
not specified, the calculations will be done using the coords of the <cite>scalargrid</cite> attribute.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Psi</strong> – Divergence-free current function evaluated at self.scalargrid, or, if specified, mlat/mlt</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>K. M. Laundal, C. C. Finlay, and N. Olsen, “Sunlight effects on the 3D polar current
system determined from low Earth orbit measurements” Earth, Planets and Space, 2016,
<a class="reference external" href="https://doi.org/10.1186/s40623-016-0518-x">https://doi.org/10.1186/s40623-016-0518-x</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.get_ground_perturbation">
<code class="descname">get_ground_perturbation</code><span class="sig-paren">(</span><em>mlat</em>, <em>mlt</em>, <em>height=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.get_ground_perturbation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.get_ground_perturbation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate magnetic field perturbations on ground, in units of nT, that corresponds
to the divergence-free current function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mlat</strong> (<em>numpy.ndarray</em><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – magnetic latitude of the output. The array shape will not be preserved, and
the results will be returned as a 1-dimensional array</li>
<li><strong>mlt</strong> (<em>numpy.ndarray</em><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – magnetic local time of the output. The array shape will not be preserved, and
the results will be returned as a 1-dimensional array</li>
<li><strong>height</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – geodetic height at which the field should be evalulated. Should be &lt; current height
set at initialization. Default 0 (ground)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>These calculations are made by assuming that the divergende-free current function calculated
with the AMPS model correspond to the equivalent current function of an external
magnetic potential, as described by Chapman &amp; Bartels 1940 <a class="footnote-reference" href="#id5" id="id3">[2]</a>. Induced components are
thus ignored. The height of the current function also becomes important when propagating
the model values to the ground.</p>
<p>Also note that the output parameters will be QD components, and that they can be converted
to geographic by use of QD base vectors <a class="footnote-reference" href="#id6" id="id4">[3]</a></p>
<p class="last">This function is not optimized for calculating long time series of model ground
magnetic field perturbations, although it is possible to use for that.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>dB_east</strong> (<em>numpy.ndarray</em>) – Eastward component of the magnetic field disturbance on ground</li>
<li><strong>dB_north</strong> (<em>numpy.ndarray</em>) – Northward component of the magnetic field disurubance on ground</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td><ol class="first last upperalpha simple" start="19">
<li>Chapman &amp; J. Bartels “Geomagnetism Vol 2” Oxford University Press 1940</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[3]</a></td><td>A. D. Richmond, “Ionospheric Electrodynamics Using Magnetic Apex Coordinates”,
Journal of geomagnetism and geoelectricity Vol. 47, 1995, <a class="reference external" href="http://doi.org/10.5636/jgg.47.191">http://doi.org/10.5636/jgg.47.191</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.get_integrated_upward_current">
<code class="descname">get_integrated_upward_current</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.get_integrated_upward_current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.get_integrated_upward_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the integrated upward and downward current, poleward of <cite>minlat</cite>,
in units of MA.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This calculation uses the scalargrid attribute. By default this is a <em>regular</em> grid,
with coordinates from north and south tiled side-by-side (equal number of coords,
with north first). If scalargrid has been changed, and has a different structure,
this function will return wrong values.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>J_up_n</strong> (<em>float</em>) – Total upward current in the northern hemisphere</li>
<li><strong>J_down_n</strong> (<em>float</em>) – Total downward current in the northern hemisphere</li>
<li><strong>J_up_s</strong> (<em>float</em>) – Total upward current in the southern hemisphere</li>
<li><strong>J_down_s</strong> (<em>float</em>) – Total downward current in the southern hemisphere</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.get_poloidal_scalar">
<code class="descname">get_poloidal_scalar</code><span class="sig-paren">(</span><em>mlat=&lt;object object&gt;</em>, <em>mlt=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.get_poloidal_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.get_poloidal_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the poloidal scalar potential values (unit is microTm).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mlat</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlats at which to calculate the poloidal scalar. Will be ignored if mlt is not
also specified. If not specified, the calculations will be done using the coords of the
<cite>scalargrid</cite> attribute.</li>
<li><strong>mlt</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlts at which to calculate the poloidal scalar. Will be ignored if mlat is not
also specified. If not specified, the calculations will be done using the coords of the
<cite>scalargrid</cite> attribute.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>V</strong> – Poloidal scalar evalulated at self.scalargrid, or, if specified, mlat/mlt</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.get_toroidal_scalar">
<code class="descname">get_toroidal_scalar</code><span class="sig-paren">(</span><em>mlat=&lt;object object&gt;</em>, <em>mlt=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.get_toroidal_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.get_toroidal_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the toroidal scalar values (unit is nT).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mlat</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlats at which to calculate the toroidal scalar. Will be ignored if mlt is not
also specified. If not specified, the calculations will be done using the coords of the
<cite>scalargrid</cite> attribute.</li>
<li><strong>mlt</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlts at which to calculate the toroidal scalar. Will be ignored if mlat is not
also specified. If not specified, the calculations will be done using the coords of the
<cite>scalargrid</cite> attribute.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>T</strong> – Toroidal scalar evaluated at self.scalargrid, or, if specified, mlat/mlt</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.get_total_current">
<code class="descname">get_total_current</code><span class="sig-paren">(</span><em>mlat=&lt;object object&gt;</em>, <em>mlt=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.get_total_current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.get_total_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the total horizontal current, in units of mA/m. This is calculated as
the sum of the curl-free and divergence-free parts. The calculations refer to
the height chosen upon initialization of the AMPS object (default 110 km).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mlat</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlats at which to calculate the current. Will be ignored if mlt is not also specified. If
not specified, the calculations will be done using the coords of the <cite>vectorgrid</cite> attribute.</li>
<li><strong>mlt</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlts at which to calculate the current. Will be ignored if mlat is not also specified. If
not specified, the calculations will be done using the coords of the <cite>vectorgrid</cite> attribute.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>j_eastward</strong> (<em>numpy.ndarray, float</em>) – eastward component of the horizontal current evalulated at the coordinates given by the <cite>vectorgrid</cite> attribute</li>
<li><strong>j_northward</strong> (<em>numpy.ndarray, float</em>) – northward component of the horizontal current evalulated at the coordinates given by the <cite>vectorgrid</cite> attribute</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#pyamps.AMPS.get_divergence_free_current" title="pyamps.AMPS.get_divergence_free_current"><code class="xref py py-meth docutils literal"><span class="pre">get_divergence_free_current()</span></code></a></dt>
<dd>Calculate divergence-free part of the horizontal current</dd>
<dt><a class="reference internal" href="#pyamps.AMPS.get_curl_free_current" title="pyamps.AMPS.get_curl_free_current"><code class="xref py py-meth docutils literal"><span class="pre">get_curl_free_current()</span></code></a></dt>
<dd>Calculate curl-free part of the horizontal current</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.get_upward_current">
<code class="descname">get_upward_current</code><span class="sig-paren">(</span><em>mlat=&lt;object object&gt;</em>, <em>mlt=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.get_upward_current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.get_upward_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the upward current (unit is microAmps per square meter). The
calculations refer to the height chosen upon initialization of the
AMPS object (default 110 km).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mlat</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlats at which to calculate the current. Will be ignored if mlt is not also specified. If
not specified, the calculations will be done using the coords of the <cite>scalargrid</cite> attribute.</li>
<li><strong>mlt</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – array of mlts at which to calculate the current. Will be ignored if mlat is not also specified. If
not specified, the calculations will be done using the coords of the <cite>scalargrid</cite> attribute.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Ju</strong> – Upward current evaulated at self.scalargrid, or, if specified, mlat/mlt</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.plot_currents">
<code class="descname">plot_currents</code><span class="sig-paren">(</span><em>vector_scale=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.plot_currents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.plot_currents" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a summary plot of the current fields</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vector_scale</strong> (<em>optional</em>) – Current vector lengths will be shown relative to a template. This parameter determines
the magnitude of that template, in mA/m. Default is 200 mA/m</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># initialize by supplying a set of external conditions:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">AMPS</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="c1"># solar wind velocity in km/s</span>
<span class="go">             -4, # IMF By in nT</span>
<span class="go">             -3, # IMF Bz in nT</span>
<span class="go">             20, # dipole tilt angle in degrees</span>
<span class="go">             150) # F10.7 index in s.f.u.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make summary plot:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">plot_currents</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyamps.AMPS.update_model">
<code class="descname">update_model</code><span class="sig-paren">(</span><em>v</em>, <em>By</em>, <em>Bz</em>, <em>tilt</em>, <em>F107</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#AMPS.update_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.AMPS.update_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the model vectors without updating all the other matrices. This leads to better
performance than just making a new AMPS object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>v</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – solar wind velocity in km/s</li>
<li><strong>By</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – IMF GSM y component in nT</li>
<li><strong>Bz</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – IMF GSM z component in nT</li>
<li><strong>tilt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – dipole tilt angle in degrees</li>
<li><strong>F107</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – F10.7 index in s.f.u.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>If model currents shall be calculated on the same grid for a range of
external conditions, it is faster to do this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m1</span> <span class="o">=</span> <span class="n">AMPS</span><span class="p">(</span><span class="n">solar_wind_velocity_in_km_per_s</span><span class="p">,</span> <span class="n">IMF_By_in_nT</span><span class="p">,</span> <span class="n">IMF_Bz_in_nT</span><span class="p">,</span> <span class="n">dipole_tilt_in_deg</span><span class="p">,</span> <span class="n">F107_index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... current calculations ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1</span><span class="o">.</span><span class="n">update_model</span><span class="p">(</span><span class="n">new_v</span><span class="p">,</span> <span class="n">new_By</span><span class="p">,</span> <span class="n">new_Bz</span><span class="p">,</span> <span class="n">new_tilt</span><span class="p">,</span> <span class="n">new_F107</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... new current calcuations ...</span>
</pre></div>
</div>
<p>than to make a new object:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m2</span> <span class="o">=</span> <span class="n">AMPS</span><span class="p">(</span><span class="n">new_v</span><span class="p">,</span> <span class="n">new_By</span><span class="p">,</span> <span class="n">new_Bz</span><span class="p">,</span> <span class="n">new_tilt</span><span class="p">,</span> <span class="n">new_F107</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... new current calculations ...</span>
</pre></div>
</div>
<p>Also note that the inputs are scalars in both cases. It is possible to optimize the calculations significantly
by allowing the inputs to be arrays. That is not yet implemented.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyamps.get_B_ground">
<code class="descclassname">pyamps.</code><code class="descname">get_B_ground</code><span class="sig-paren">(</span><em>qdlat</em>, <em>mlt</em>, <em>height</em>, <em>v</em>, <em>By</em>, <em>Bz</em>, <em>tilt</em>, <em>f107</em>, <em>current_height=110</em>, <em>epsilon_multiplier=1.0</em>, <em>chunksize=25000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#get_B_ground"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.get_B_ground" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate model magnetic field on ground</p>
<p>This function uses dask to parallelize computations. That means that it is quite
fast and that the memory consumption will not explode unless <cite>chunksize</cite> is too large.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qdlat</strong> (<em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – quasi-dipole latitude, in degrees. Can be either a scalar (float), or
an array with an equal number of elements as mlt</li>
<li><strong>mlt</strong> (<em>array_like</em>) – array of magnetic local times (hours)</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – geodetic height, in km (0 &lt;= height &lt;= current_height)</li>
<li><strong>v</strong> (<em>array_like</em>) – array of solar wind velocities in GSM/GSE x direction (km/s)</li>
<li><strong>By</strong> (<em>array_like</em>) – array of solar wind By values (nT)</li>
<li><strong>Bz</strong> (<em>array_like</em>) – array of solar wind Bz values (nT)</li>
<li><strong>tilt</strong> (<em>array_like</em>) – array of dipole tilt angles (degrees)</li>
<li><strong>f107</strong> (<em>array_like</em>) – array of F10.7 index values (SFU)</li>
<li><strong>current_height</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) – height (km) of the current sheet. Default is 110.</li>
<li><strong>epsilon_multiplier</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) – multiplier for the epsilon parameter. Default is 1.</li>
<li><strong>chunksize</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – the input arrays will be split in chunks in order to parallelize
computations. Larger chunks consumes more memory, but might be faster. Default is 25000.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>Bqphi</strong> (<em>array_like</em>) – magnetic field in quasi-dipole eastward direction</li>
<li><strong>Bqlambda</strong> (<em>array_like</em>) – magnetic field in quasi-dipole northward direction</li>
<li><strong>Bqr</strong> (<em>array_like</em>) – magnetic field in upward direction. See notes</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>We assume that there are no induced currents. The error in this assumption will be larger
for the radial component than for the horizontal components</p>
<p class="last">Array inputs should have the same dimensions.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyamps.get_B_space">
<code class="descclassname">pyamps.</code><code class="descname">get_B_space</code><span class="sig-paren">(</span><em>glat</em>, <em>glon</em>, <em>height</em>, <em>time</em>, <em>v</em>, <em>By</em>, <em>Bz</em>, <em>tilt</em>, <em>f107</em>, <em>epoch=2015.0</em>, <em>h_R=110.0</em>, <em>chunksize=15000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/amps.html#get_B_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.get_B_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate model magnetic field in space</p>
<p>This function uses dask to parallelize computations. That means that it is quite
fast and that the memory consumption will not explode unless <cite>chunksize</cite> is too large.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>glat</strong> (<em>array_like</em>) – array of geographic latitudes (degrees)</li>
<li><strong>glon</strong> (<em>array_like</em>) – array of geographic longitudes (degrees)</li>
<li><strong>height</strong> (<em>array_like</em>) – array of geodetic heights (km)</li>
<li><strong>time</strong> (<em>array_like</em>) – list/array of datetimes, needed to calculate magnetic local time</li>
<li><strong>v</strong> (<em>array_like</em>) – array of solar wind velocities in GSM/GSE x direction (km/s)</li>
<li><strong>By</strong> (<em>array_like</em>) – array of solar wind By values (nT)</li>
<li><strong>Bz</strong> (<em>array_like</em>) – array of solar wind Bz values (nT)</li>
<li><strong>tilt</strong> (<em>array_like</em>) – array of dipole tilt angles (degrees)</li>
<li><strong>f107</strong> (<em>array_like</em>) – array of F10.7 index values (SFU)</li>
<li><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) – epoch (year) used in conversion to magnetic coordinates with the IGRF. Default = 2015.</li>
<li><strong>h_R</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) – referene height (km) used when calculating modified apex coordinates. Default = 110.</li>
<li><strong>chunksize</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) – the input arrays will be split in chunks in order to parallelize
computations. Larger chunks consumes more memory, but might be faster. Default is 15000.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>Be</strong> (<em>array_like</em>) – array of model magnetic field (nT) in geodetic eastward direction
(same dimension as input)</li>
<li><strong>Bn</strong> (<em>array_like</em>) – array of model magnetic field (nT) in geodetic northward direction
(same dimension as input)</li>
<li><strong>Bu</strong> (<em>array_like</em>) – array of model magnetic field (nT) in geodetic upward direction
(same dimension as input)</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Array inputs should have the same dimensions.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyamps.mlon_to_mlt">
<code class="descclassname">pyamps.</code><code class="descname">mlon_to_mlt</code><span class="sig-paren">(</span><em>mlon</em>, <em>times</em>, <em>epoch</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/mlt_utils.html#mlon_to_mlt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.mlon_to_mlt" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate magnetic local time from magnetic longitude and time(s).</p>
<p>This is an implementation of the formula recommended in Laundal &amp; Richmond, 2017 <a href="#id12"><span class="problematic" id="id7">[4]_</span></a>.
It uses the subsolar point geomagnetic (centered dipole) longitude to define
the noon meridian.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mlon</strong> (<em>array_like</em>) – array of magnetic longitudes</li>
<li><strong>times</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#module-datetime" title="(in Python v2.7)"><em>datetime</em></a><em> or </em><em>list of datetimes</em>) – datetime object, or list of datetimes with equal number of elements
as mlon</li>
<li><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – the epoch (year, ) used for geo-&gt;mag conversion</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[4]</td><td>Laundal, K.M. &amp; Richmond, A.D. Space Sci Rev (2017) 206: 27.
<a class="reference external" href="https://doi.org/10.1007/s11214-016-0275-y">https://doi.org/10.1007/s11214-016-0275-y</a></td></tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pyamps.mlt_utils">
<span id="magnetic-local-time-pyamps-mlt-utils"></span><h2>Magnetic local time (<cite>pyamps.mlt_utils</cite>)<a class="headerlink" href="#module-pyamps.mlt_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyamps.mlt_utils.car_to_sph">
<code class="descclassname">pyamps.mlt_utils.</code><code class="descname">car_to_sph</code><span class="sig-paren">(</span><em>car</em>, <em>deg=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/mlt_utils.html#car_to_sph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.mlt_utils.car_to_sph" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert from spherical to cartesian coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>car</strong> (<em>3 x N array</em>) – 3 x N array, where the rows are, from top to bottom:
x, y, z, in ECEF coordinates</li>
<li><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) – set to True if output is wanted in degrees. False if radians</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>sph</strong> – 3 x N array, where the rows are, from top to bottom:
radius, colatitude, and longitude</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">3 x N array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyamps.mlt_utils.geo2mag">
<code class="descclassname">pyamps.mlt_utils.</code><code class="descname">geo2mag</code><span class="sig-paren">(</span><em>glat</em>, <em>glon</em>, <em>epoch</em>, <em>deg=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/mlt_utils.html#geo2mag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.mlt_utils.geo2mag" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert geographic to centered dipole coordinates</p>
<p>The conversion uses IGRF coefficients directly, interpolated
to the provided epoch. The construction of the rotation matrix
follows Laundal &amp; Richmond (2017) <a href="#id13"><span class="problematic" id="id9">[4]_</span></a> quite directly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>glat</strong> (<em>array_like</em>) – array of geographic latitudes</li>
<li><strong>glon</strong> (<em>array_like</em>) – array of geographic longitudes</li>
<li><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – epoch (year) for the dipole used in the conversion</li>
<li><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) – true if input is in degrees, False otherwise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>cdlat</strong> (<em>ndarray</em>) – array of centered dipole latitudes [degrees]</li>
<li><strong>cdlon</strong> (<em>ndarray</em>) – array of centered dipole longitudes [degrees]</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyamps.mlt_utils.is_leapyear">
<code class="descclassname">pyamps.mlt_utils.</code><code class="descname">is_leapyear</code><span class="sig-paren">(</span><em>year</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/mlt_utils.html#is_leapyear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.mlt_utils.is_leapyear" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if leapyear else False</p>
<p>Handles arrays and preserves shape</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>year</strong> (<em>array_like</em>) – array of years</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>is_leapyear</strong> – True where input is leapyear, False elsewhere</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray of bools</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyamps.mlt_utils.mlon_to_mlt">
<code class="descclassname">pyamps.mlt_utils.</code><code class="descname">mlon_to_mlt</code><span class="sig-paren">(</span><em>mlon</em>, <em>times</em>, <em>epoch</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/mlt_utils.html#mlon_to_mlt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.mlt_utils.mlon_to_mlt" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate magnetic local time from magnetic longitude and time(s).</p>
<p>This is an implementation of the formula recommended in Laundal &amp; Richmond, 2017 <a href="#id14"><span class="problematic" id="id10">[4]_</span></a>.
It uses the subsolar point geomagnetic (centered dipole) longitude to define
the noon meridian.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mlon</strong> (<em>array_like</em>) – array of magnetic longitudes</li>
<li><strong>times</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#module-datetime" title="(in Python v2.7)"><em>datetime</em></a><em> or </em><em>list of datetimes</em>) – datetime object, or list of datetimes with equal number of elements
as mlon</li>
<li><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – the epoch (year, ) used for geo-&gt;mag conversion</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[4]</td><td>Laundal, K.M. &amp; Richmond, A.D. Space Sci Rev (2017) 206: 27.
<a class="reference external" href="https://doi.org/10.1007/s11214-016-0275-y">https://doi.org/10.1007/s11214-016-0275-y</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyamps.mlt_utils.sph_to_car">
<code class="descclassname">pyamps.mlt_utils.</code><code class="descname">sph_to_car</code><span class="sig-paren">(</span><em>sph</em>, <em>deg=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/mlt_utils.html#sph_to_car"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.mlt_utils.sph_to_car" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert from spherical to cartesian coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sph</strong> (<em>3 x N array</em>) – 3 x N array, where the rows are, from top to bottom:
radius, colatitude, and longitude</li>
<li><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) – set to True if input is given in degrees. False if radians</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>car</strong> – 3 x N array, where the rows are, from top to bottom:
x, y, z, in ECEF coordinates</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">3 x N array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyamps.mlt_utils.subsol">
<code class="descclassname">pyamps.mlt_utils.</code><code class="descname">subsol</code><span class="sig-paren">(</span><em>datetimes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/mlt_utils.html#subsol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.mlt_utils.subsol" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate subsolar point at given datetime(s)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>datetimes</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#module-datetime" title="(in Python v2.7)"><em>datetime</em></a><em> or </em><em>list of datetimes</em>) – datetime or list (or other iterable) of datetimes</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>subsol_lat</strong> (<em>ndarray</em>) – latitude(s) of the subsolar point</li>
<li><strong>subsol_lon</strong> (<em>ndarray</em>) – longiutde(s) of the subsolar point</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> – if any datetime.year value provided is not within (1600,2100)</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The code is vectorized, so it should be fast.</p>
<p>After Fortran code by: 961026 A. D. Richmond, NCAR</p>
<p class="last">Documentation from original code:
Find subsolar geographic latitude and longitude from date and time.
Based on formulas in Astronomical Almanac for the year 1996, p. C24.
(U.S. Government Printing Office, 1994).
Usable for years 1601-2100, inclusive.  According to the Almanac,
results are good to at least 0.01 degree latitude and 0.025 degree
longitude between years 1950 and 2050.  Accuracy for other years
has not been tested.  Every day is assumed to have exactly
86400 seconds; thus leap seconds that sometimes occur on December
31 are ignored:  their effect is below the accuracy threshold of
the algorithm.</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyamps.sh_utils">
<span id="spherical-harmonics-pyamps-sh-utils"></span><h2>Spherical harmonics (<cite>pyamps.sh_utils</cite>)<a class="headerlink" href="#module-pyamps.sh_utils" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyamps.sh_utils.SHkeys">
<em class="property">class </em><code class="descclassname">pyamps.sh_utils.</code><code class="descname">SHkeys</code><span class="sig-paren">(</span><em>Nmax</em>, <em>Mmax</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/sh_utils.html#SHkeys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.sh_utils.SHkeys" title="Permalink to this definition">¶</a></dt>
<dd><p>container for n and m in spherical harmonics</p>
<p>keys = SHkeys(Nmax, Mmax)</p>
<p>keys will behave as a tuple of tuples, more or less
keys[‘n’] will return a list of the n’s
keys[‘m’] will return a list of the m’s
keys[3] will return the fourth n,m tuple</p>
<p>keys is also iterable</p>
<dl class="method">
<dt id="pyamps.sh_utils.SHkeys.Mge">
<code class="descname">Mge</code><span class="sig-paren">(</span><em>limit</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/sh_utils.html#SHkeys.Mge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.sh_utils.SHkeys.Mge" title="Permalink to this definition">¶</a></dt>
<dd><p>set m &gt;= limit</p>
</dd></dl>

<dl class="method">
<dt id="pyamps.sh_utils.SHkeys.MleN">
<code class="descname">MleN</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/sh_utils.html#SHkeys.MleN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.sh_utils.SHkeys.MleN" title="Permalink to this definition">¶</a></dt>
<dd><p>set m &lt;= n</p>
</dd></dl>

<dl class="method">
<dt id="pyamps.sh_utils.SHkeys.NminusMeven">
<code class="descname">NminusMeven</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/sh_utils.html#SHkeys.NminusMeven"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.sh_utils.SHkeys.NminusMeven" title="Permalink to this definition">¶</a></dt>
<dd><p>remove keys if n - m is odd</p>
</dd></dl>

<dl class="method">
<dt id="pyamps.sh_utils.SHkeys.NminusModd">
<code class="descname">NminusModd</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/sh_utils.html#SHkeys.NminusModd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.sh_utils.SHkeys.NminusModd" title="Permalink to this definition">¶</a></dt>
<dd><p>remove keys if n - m is even</p>
</dd></dl>

<dl class="method">
<dt id="pyamps.sh_utils.SHkeys.make_arrays">
<code class="descname">make_arrays</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/sh_utils.html#SHkeys.make_arrays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.sh_utils.SHkeys.make_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>prepare arrays with shape ( 1, len(keys) )
these are used when making G matrices</p>
</dd></dl>

<dl class="method">
<dt id="pyamps.sh_utils.SHkeys.negative_m">
<code class="descname">negative_m</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/sh_utils.html#SHkeys.negative_m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.sh_utils.SHkeys.negative_m" title="Permalink to this definition">¶</a></dt>
<dd><p>add negative m to the keys</p>
</dd></dl>

<dl class="method">
<dt id="pyamps.sh_utils.SHkeys.setNmin">
<code class="descname">setNmin</code><span class="sig-paren">(</span><em>nmin</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/sh_utils.html#SHkeys.setNmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.sh_utils.SHkeys.setNmin" title="Permalink to this definition">¶</a></dt>
<dd><p>set minimum n</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyamps.sh_utils.getG0">
<code class="descclassname">pyamps.sh_utils.</code><code class="descname">getG0</code><span class="sig-paren">(</span><em>glat</em>, <em>glon</em>, <em>height</em>, <em>time</em>, <em>epoch=2015.0</em>, <em>h_R=110.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/sh_utils.html#getG0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.sh_utils.getG0" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate the G matrix for the constant term in the AMPS model. The constant term is the
term that depends only on the spherical harmonic coefficients that are not scaled by
external parameters. This G matrix can be used to produce the full matrix.</p>
<p>The structure of the matrix is such that G0.dot(m), the product of the matrix with the
first 1/19 of the model vector, will be model values of the eastward, northward, and
upward components of the magnetic field, stacked in a column vector.</p>
<p>glat, glon, time, and height must all have the same number of elements (let’s call this N)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>glat</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) – Geodetic latitude (degrees)</li>
<li><strong>glon</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) – Geographic/geodetic longitude (degrees)</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) – Geodetic heights, in km</li>
<li><strong>time</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) – Array of datetimes correspondign to each point. This is needed to calculate
magnetic local time.</li>
<li><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) – The epoch used for conversion to apex coordinates. Default 2015.</li>
<li><strong>h_R</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) – Reference height used in conversion to modified apex coordinates. Default 110 km.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>G0</strong> – an 3N by M matrix, where N is the number of elements in the input coordinates. There will be
3 times as many rows G0, since there are 3 components. Partionining G0 in thirds, from top to
bottom, gives the parts that correspond to east, north, and up, respectively. M
is the number of terms in the spherical harmonic expansion of B</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyamps.sh_utils.get_ground_field_G0">
<code class="descclassname">pyamps.sh_utils.</code><code class="descname">get_ground_field_G0</code><span class="sig-paren">(</span><em>qdlat</em>, <em>mlt</em>, <em>height</em>, <em>current_height</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/sh_utils.html#get_ground_field_G0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.sh_utils.get_ground_field_G0" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate the G matrix for the constant term in the AMPS model needed to calculate
corresponding ground magnetic field perturbations. The constant term is the
term that depends only on the spherical harmonic coefficients that are not scaled by
external parameters. This G matrix can be used to produce the full matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qdlat</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) – Quasi-dipole latitude (degrees)</li>
<li><strong>MLT</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) – Magnetic local time (MLT)</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Geodetic height, in km (0 &lt;= height &lt;= current_height)</li>
<li><strong>current_height</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – height of the current</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>G0</strong> – an 3N by M matrix, where N is the number of elements in the input coordinates. There will be
3 times as many rows G0, since there are 3 components. Partionining G0 in thirds, from top to
bottom, gives the parts that correspond to east, north, and up, respectively. M
is the number of terms in the spherical harmonic expansion of B</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyamps.sh_utils.legendre">
<code class="descclassname">pyamps.sh_utils.</code><code class="descname">legendre</code><span class="sig-paren">(</span><em>nmax</em>, <em>mmax</em>, <em>theta</em>, <em>schmidtnormalize=True</em>, <em>keys=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/sh_utils.html#legendre"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.sh_utils.legendre" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate associated Legendre function P and its derivative</p>
<p>Algorithm from “Spacecraft Attitude Determination and Control” by James Richard Wertz</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nmax</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – highest spherical harmonic degree</li>
<li><strong>mmax</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – hightest spherical harmonic order</li>
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – colatitude in degrees (shape is not preserved)</li>
<li><strong>schmidtnormalize</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) – True if Schmidth seminormalization is wanted, False otherwise. Default True</li>
<li><strong>keys</strong> (<a class="reference internal" href="#pyamps.sh_utils.SHkeys" title="pyamps.sh_utils.SHkeys"><em>SHkeys</em></a><em>, </em><em>optional</em>) – If this parameter is set, an array will be returned instead of a dict.
The array will be (N, 2M), where N is the number of elements in <cite>theta</cite>, and
M is the number of keys. The first M columns represents a matrix of P values,
and the last M columns represent values of dP/dtheta</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>P</strong> (<em>dict</em>) – dictionary of Legendre function evalulated at theta. Dictionary keys are spherical harmonic
wave number tuples (n, m), and values will have shape (N, 1), where N is number of
elements in <cite>theta</cite>.</li>
<li><strong>dP</strong> (<em>dict</em>) – dictionary of Legendre function derivatives evaluated at theta. Dictionary keys are spherical
harmonic wave number tuples (n, m), and values will have shape (N, 1), where N is number of
elements in theta.</li>
<li><strong>PdP</strong> (<em>array (only if keys != None)</em>) – if keys != None, PdP is returned instaed of P and dP. PdP is an (N, 2M) array, where N is
the number of elements in <cite>theta</cite>, and M is the number of keys. The first M columns represents
a matrix of P values, and the last M columns represent values of dP/dtheta</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyamps.sh_utils.nterms">
<code class="descclassname">pyamps.sh_utils.</code><code class="descname">nterms</code><span class="sig-paren">(</span><em>NT=0</em>, <em>MT=0</em>, <em>NVi=0</em>, <em>MVi=0</em>, <em>NVe=0</em>, <em>MVe=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/sh_utils.html#nterms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.sh_utils.nterms" title="Permalink to this definition">¶</a></dt>
<dd><p>return number of coefficients in an expansion in real spherical harmonics of
toroidal magnetic potential truncated at NT, MT
poloidal magnetic potential truncated at NVi, MVi for internal sources
poloidal magnetic potential truncated at NVe, MVe for external sources</p>
</dd></dl>

</div>
<div class="section" id="module-pyamps.model_utils">
<span id="amps-model-parameters-pyamps-model-utils"></span><h2>AMPS model parameters (<cite>pyamps.model_utils</cite>)<a class="headerlink" href="#module-pyamps.model_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyamps.model_utils.get_model_vectors">
<code class="descclassname">pyamps.model_utils.</code><code class="descname">get_model_vectors</code><span class="sig-paren">(</span><em>v</em>, <em>By</em>, <em>Bz</em>, <em>tilt</em>, <em>f107</em>, <em>epsilon_multiplier=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/model_utils.html#get_model_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.model_utils.get_model_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>tor_c, tor_s, pol_c, pol_s = get_model_vectors(v, By, Bz, tilt, F107)</p>
<p>returns column vectors ((K,1)-shaped) corresponding to the spherical harmonic coefficients of the toroidal
and poloidal parts, with _c and _s denoting cos and sin terms, respectively.</p>
<p>This function is used by amps.AMPS class</p>
</dd></dl>

</div>
<div class="section" id="module-pyamps.plot_utils">
<span id="polar-coordinate-plots-pyamps-plot-utils"></span><h2>Polar coordinate plots (<cite>pyamps.plot_utils</cite>)<a class="headerlink" href="#module-pyamps.plot_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyamps.plot_utils.equal_area_grid">
<code class="descclassname">pyamps.plot_utils.</code><code class="descname">equal_area_grid</code><span class="sig-paren">(</span><em>dr=2</em>, <em>K=0</em>, <em>M0=8</em>, <em>N=20</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyamps/plot_utils.html#equal_area_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyamps.plot_utils.equal_area_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>function for calculating an equal area grid in polar coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dr</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – The latitudinal resolution of the grid. Default 2 degrees</li>
<li><strong>K</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – This number determines the colatitude of the inner radius of the
post poleward ring of grid cells (the pole is not inlcluded!).
It relates to this colatitude (r0) as r0/dr = (2K + 1)/2 =&gt; K = (2r0/dr - 1)/2.
Default value is 0</li>
<li><strong>M0</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – The number of sectors in the most poleward ring. Default is 8</li>
<li><strong>N</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – The number of rings to be included. This determiend how far
equatorward the grid extends. Typically if dr is changed from 2 to 1,
N should be doubled to reach the same latitude. Default is 20, which means
that the equatorward edge of the grid is 89 - 20*2 = 49 degrees
(the most poleward latitude is 89 with default values)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>mlat</strong> (<em>array</em>) – Array of latitudes for the equatorward west (“lower left”) corners of the grid
cells.</li>
<li><strong>mlt</strong> (<em>array</em>) – Array of magnetic local times for the equatorward west (“lower left”) corner
of the grid cells.</li>
<li><strong>mltres</strong> (<em>array</em>) – width, in magnetic local time, of the cells with lower left corners described
by mlat and mlt. Notice that this width changes with latitude, while the
latitudinal width is fixed, determined by the <cite>dr</cite> parameter</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyamps">Core functionality (<cite>pyamps</cite>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyamps.mlt_utils">Magnetic local time (<cite>pyamps.mlt_utils</cite>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyamps.sh_utils">Spherical harmonics (<cite>pyamps.sh_utils</cite>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyamps.model_utils">AMPS model parameters (<cite>pyamps.model_utils</cite>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyamps.plot_utils">Polar coordinate plots (<cite>pyamps.plot_utils</cite>)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_coefficients.html">Coefficient file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installation.html"
                        title="previous chapter">Installation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="model_coefficients.html"
                        title="next chapter">Coefficient file format</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/reference.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="model_coefficients.html" title="Coefficient file format"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyAMPS 1.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Karl M. Laundal.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>