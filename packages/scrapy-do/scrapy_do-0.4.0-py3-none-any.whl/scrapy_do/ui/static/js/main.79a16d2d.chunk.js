(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{168:function(e,t,a){e.exports=a(463)},175:function(e,t,a){},176:function(e,t,a){},463:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(23),c=a.n(s),o=(a(173),a(174),a(175),a(176),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function i(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var l=a(56),u=a(75),d=a(24),m=a(22);function h(e){return{type:"BACKEND_STATUS_SET",status:e}}var p={status:"BACKEND_CONNECTING",countdown:0};var E={memoryUsage:0,cpuUsage:0,time:0,timezone:"UTC",hostname:"unknown",uptime:"0m",daemonVersion:"0.0.0",projects:0,spiders:0,jobsRun:0,jobsSuccessful:0,jobsFailed:0,jobsCanceled:0,jobsScheduled:0};var b=a(63);var f={};var v={};function y(e,t){var a=Object.assign(e);return"ACTIVE"in a&&delete a.ACTIVE[t],"COMPLETED"in a&&delete a.COMPLETED[t],a}function j(e){return"SCHEDULED"===e||"PENDING"===e||"RUNNING"===e?"ACTIVE":"COMPLETED"}var g=a(10);function O(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function C(e){if("now"===e)return!0;var t=e.toLowerCase().split(" ");if(0===t.length)return!1;if("every"!==t[0])return!1;if(t.length<2)return!1;var a=parseInt(t[1],10);if(isNaN(a))t=t.slice(1);else{if(t.length<3)return!1;t=t.slice(2)}var n=["second","seconds","minute","minutes","hour","hours","day","days","week","weeks","monday","tuesday","wednesday","thursday","friday","saturday","sunday","at","to"];for(t=t.reverse();t.length;){var r=t.pop();if(n.indexOf(r)<0)return!1;if("to"===r){if(!t.length)return!1;var s=t.pop();if(s=parseInt(s,10),isNaN(s))return!1}else if("at"===r){if(!t.length)return!1;var c=t.pop(),o=c.split(":");if(2!==o.length)return!1;if(c=parseInt(o[0],10),isNaN(c))return!1;if(c=parseInt(o[1],10),isNaN(c))return!1}}return!0}function w(e){var t=null;try{t=JSON.parse(e)}catch(a){return!1}return"object"===typeof t&&null!==t}var S=function e(){var t=this;Object(g.a)(this,e),this.connect=function(){if(t.ws)throw Error("Socket not closed");t.countdownTimer&&clearInterval(t.countdownTimer),t.dispatchEvent(e.CONNECTING,null),t.ws=new WebSocket(t.wsUrl),t.ws.onopen=function(){t.dispatchEvent(e.OPENED,null),t.nextTry=2},t.ws.onmessage=function(a){var n=JSON.parse(a.data);t.dispatchEvent(e.MSG_RECEIVED,n)},t.ws.onclose=function(){t.dispatchEvent(e.CLOSED,null),t.ws=null,t.nextTry*=2,t.nextTry>256&&(t.nextTry=256),t.countdown=t.nextTry-1,t.dispatchEvent(e.COUNTDOWN,t.countdown+1);t.countdownTimer=setInterval((function(){t.dispatchEvent(e.COUNTDOWN,t.countdown),0!==t.countdown?t.countdown-=1:t.connect()}),1e3)}},this.addEventListener=function(e){t.eventListeners.add(e)},this.removeEventListener=function(e){t.eventListeners.delete(e)},this.dispatchEvent=function(a,n){var r=[],s=!0,c=!1,o=void 0;try{for(var i,l=t.eventListeners[Symbol.iterator]();!(s=(i=l.next()).done);s=!0){var u=i.value;u(a,n)===e.REMOVE_LISTENER&&r.push(u)}}catch(p){c=!0,o=p}finally{try{s||null==l.return||l.return()}finally{if(c)throw o}}for(var d=0,m=r;d<m.length;d++){var h=m[d];t.removeEventListener(h)}},this.sendMessage=function(a){if(!t.ws||t.ws.readyState!==WebSocket.OPEN)return Promise.reject(new Error("Backend not connected."));var n=function(e){for(var t="",a="abcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*a.length));return t}(32),r=Object.assign(a,{type:"ACTION",id:n});return new Promise((function(a,s){t.addEventListener((function(t,r){if(t===e.CLOSED)return s(new Error("Backend disconnected")),e.REMOVE_LISTENER;if(t===e.MSG_RECEIVED&&"ACTION_EXECUTED"===r.type&&r.id===n){if("OK"===r.status){var c=Object.assign(r);delete c.type,delete c.id,delete c.status,a(c)}else s(new Error(r.message));return e.REMOVE_LISTENER}return null})),t.ws.send(JSON.stringify(r))}))};var a=window.location,n="https:"===a.protocol?"wss:":"ws:";this.wsUrl="".concat(n,"//").concat(a.host,"/ws"),this.ws=null,this.countdownTimer=null,this.countdown=0,this.nextTry=2,this.eventListeners=new Set,this.connect()};S.CONNECTING=0,S.OPENED=1,S.CLOSED=2,S.MSG_RECEIVED=3,S.COUNTDOWN=4,S.REMOVE_LISTENER=0;var N=new S,T=a(13),D=a(15),_=a(14),k=a(16),I=a(50),L=a(25),P=a(58),U=a(79),A=a(67),x=function(e){function t(){return Object(g.a)(this,t),Object(D.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){return r.a.createElement(U.a,{bg:"dark",variant:"dark",collapseOnSelect:!0,expand:"md"},r.a.createElement(A.LinkContainer,{to:"/"},r.a.createElement(U.a.Brand,null,"Scrapy Do")),r.a.createElement(U.a.Toggle,{"aria-controls":"navbar"}),r.a.createElement(U.a.Collapse,{id:"navbar"},r.a.createElement(P.a,{className:"mr-auto"}),r.a.createElement(P.a,null,r.a.createElement(A.LinkContainer,{to:"/dashboard"},r.a.createElement(P.a.Link,null,r.a.createElement(L.d,null)," Dashboard")),r.a.createElement(A.LinkContainer,{to:"/project-list"},r.a.createElement(P.a.Link,null,r.a.createElement(L.a,null)," Projects")),r.a.createElement(A.LinkContainer,{to:"/job-list/active"},r.a.createElement(P.a.Link,null,r.a.createElement(L.b,null)," Active Jobs")),r.a.createElement(A.LinkContainer,{to:"/job-list/completed"},r.a.createElement(P.a.Link,null,r.a.createElement(L.g,null)," Completed Jobs")))))}}]),t}(n.Component),M=a(127),R=function(e){function t(){return Object(g.a)(this,t),Object(D.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){return"BACKEND_OPENED"===this.props.status?r.a.createElement("div",null):"BACKEND_CONNECTING"===this.props.status?r.a.createElement("div",{className:"col-md-4 col-md-offset-4"},r.a.createElement(M.a,{variant:"primary",onClick:this.retryNow},r.a.createElement("div",{className:"alert-content"},"Connecting..."))):r.a.createElement("div",{className:"col-md-4 col-md-offset-4"},r.a.createElement(M.a,{variant:"primary",type:"button"},r.a.createElement("div",{className:"alert-content"},"Disconnected. Connecting in",r.a.createElement("strong",null," ",this.props.countdown),1===this.props.countdown?" second":" seconds",". Click ",r.a.createElement("a",{className:"alert-link",onClick:function(e){e.preventDefault(),N.connect()},href:"#n"},"here")," to try now.")))}}]),t}(n.Component);var B=Object(d.b)((function(e,t){return{status:e.backend.status,countdown:e.backend.countdown}}),(function(e){return{}}))(R),J=a(465),V=a(98),z=a.n(V),K=function(e){function t(){return Object(g.a)(this,t),Object(D.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=z.a.unix(this.props.time).tz(this.props.timezone).format("YYYY-MM-DD HH:mm");return r.a.createElement("div",{className:"col-md-6 col-md-offset-3"},r.a.createElement("div",{className:"dashboard-content"},r.a.createElement("img",{src:"scrapy-do-logo.png",alt:"Scrapy-Do Logo"}),r.a.createElement("div",{className:"text-summary"},r.a.createElement("div",null,"Version ",this.props.daemonVersion," @ ",this.props.hostname),r.a.createElement("div",null,"Server time: ",e," (",this.props.timezone,")"),r.a.createElement("div",null,"Uptime: ",this.props.uptime," | CPU Usage: ",this.props.cpuUsage,"% | Memory Usage: ",this.props.memoryUsage,"MB"),r.a.createElement("div",null,"Projects: ",this.props.projects," | Spiders: ",this.props.spiders),r.a.createElement("div",{className:"jobs-summary"},r.a.createElement(J.a,{striped:!0,bordered:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Jobs Run"),r.a.createElement("th",null,"Successful"),r.a.createElement("th",null,"Failed"),r.a.createElement("th",null,"Canceled"),r.a.createElement("th",null,"Scheduled"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,this.props.jobsRun),r.a.createElement("td",null,this.props.jobsSuccessful),r.a.createElement("td",null,this.props.jobsFailed),r.a.createElement("td",null,this.props.jobsCanceled),r.a.createElement("td",null,this.props.jobsScheduled)))))),r.a.createElement("div",{className:"text-summary"},"[",r.a.createElement(l.Link,{to:"/about"},"About"),"]")))}}]),t}(n.Component);var G=Object(d.b)((function(e,t){return Object(m.a)({},e.status)}),(function(e){return{}}))(K),F=a(20),W=a(51);function H(e){return N.sendMessage({action:"PROJECT_REMOVE",name:e})}function Y(e){return N.sendMessage({action:"PROJECT_PUSH",archiveData:e})}function X(e){return N.sendMessage({action:"JOB_CANCEL",jobId:e})}function q(e,t,a,n,r){return N.sendMessage({action:"JOB_SCHEDULE",project:e,spider:t,schedule:a,description:n,payload:r})}var Q=a(27),$=a(21),Z=function(e){function t(){var e,a;Object(g.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(D.a)(this,(e=Object(_.a)(t)).call.apply(e,[this].concat(r)))).state={visible:!1,text:""},a.close=function(){a.setState({visible:!1})},a.show=function(e){a.setState({visible:!0,text:e})},a}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){return r.a.createElement(Q.a,{show:this.state.visible,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,size:"sm"},r.a.createElement(Q.a.Body,null,r.a.createElement("div",{className:"dialog-content-center"},this.state.text),r.a.createElement("hr",null),r.a.createElement("div",{className:"alert-content"},r.a.createElement(F.a,{variant:"secondary",onClick:this.close},"OK"))))}}]),t}(n.Component),ee=function(e){function t(){var e,a;Object(g.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(D.a)(this,(e=Object(_.a)(t)).call.apply(e,[this].concat(r)))).state={visible:!1,project:"__select",spider:"__select",schedule:"now",description:"",payload:"{\n}",projectsDisabled:!1,spidersDisabled:!0,scheduleDisabled:!0,submitDisabled:!0,scheduleValidated:!0,payloadValidated:!0},a.close=function(){a.setState({visible:!1})},a.show=function(e,t){a.setState({visible:!0,project:e||"__select",spider:t||"__select",schedule:"now",description:"",payload:"{\n}",projectsDisabled:!!e,spidersDisabled:!0,scheduleDisabled:!e||!t,submitDisabled:!e||!t,scheduleValidated:!0,payloadValidated:!0})},a.schedule=function(){q(a.state.project,a.state.spider,a.state.schedule,a.state.description,a.state.payload).catch((function(e){setTimeout((function(){return a.alert.show(e.message)}),250)})),a.close()},a.onProjectChange=function(e){"__select"===e.target.value?a.setState({spidersDisabled:!0,scheduleDisabled:!0,submitDisabled:!0,project:e.target.value}):a.setState({spidersDisabled:!1,project:e.target.value})},a.onSpiderChange=function(e){"__select"===e.target.value?a.setState({scheduleDisabled:!0,submitDisabled:!0,spider:e.target.value}):a.setState({scheduleDisabled:!1,submitDisabled:!C(a.state.schedule),spider:e.target.value})},a.onScheduleChange=function(e){var t=C(e.target.value);a.setState({schedule:e.target.value,scheduleValidated:t,submitDisabled:!t})},a.onPayloadChange=function(e){var t=w(e.target.value);a.setState({payload:e.target.value,payloadValidated:t,submitDisabled:!t})},a}return Object(k.a)(t,e),Object(T.a)(t,[{key:"componentDidMount",value:function(){this.props.provideController({show:this.show})}},{key:"componentWillUnmount",value:function(){this.props.provideController(null)}},{key:"render",value:function(){var e=this,t=r.a.createElement($.a.Group,{controlId:"projectSelect"},r.a.createElement($.a.Label,null,"Project"),r.a.createElement($.a.Control,{as:"select",placeholder:"__select",disabled:this.state.projectsDisabled,onChange:this.onProjectChange,value:this.state.project},r.a.createElement("option",{value:"__select"},"Select Project"),this.props.__projects.map((function(e){return r.a.createElement("option",{key:e,value:e},e)})))),a=[];"__select"!==this.state.project&&this.state.project in this.props&&(a=this.props[this.state.project].spiders);var n=r.a.createElement($.a.Group,{controlId:"spiderSelect"},r.a.createElement($.a.Label,null,"Spider"),r.a.createElement($.a.Control,{as:"select",placeholder:"__select",disabled:this.state.spidersDisabled,onChange:this.onSpiderChange,value:this.state.spider},r.a.createElement("option",{value:"__select"},"Select Spider"),a.map((function(e){return r.a.createElement("option",{key:e,value:e},e)})))),s="https://scrapy-do.readthedocs.io/en/latest/basic-concepts.html#scheduling-specs",c=r.a.createElement($.a.Group,{controlId:"scheduleInput"},r.a.createElement($.a.Label,null,"Schedule"),r.a.createElement($.a.Control,{type:"text",disabled:this.state.scheduleDisabled,value:this.state.schedule,onChange:this.onScheduleChange,isInvalid:!this.state.scheduleValidated,isValid:this.state.scheduleValidated}),r.a.createElement($.a.Control.Feedback,{type:"valid"},"See the ",r.a.createElement("a",{href:s},"docs")," on scheduling specs."),r.a.createElement($.a.Control.Feedback,{type:"invalid"},"See the ",r.a.createElement("a",{href:s},"docs")," on scheduling specs.")),o=r.a.createElement($.a.Group,{controlId:"descriptionInput"},r.a.createElement($.a.Label,null,"Description (optional)"),r.a.createElement($.a.Control,{type:"text",disabled:this.state.scheduleDisabled,value:this.state.description,onChange:function(t){return e.setState({description:t.target.value})}})),i=r.a.createElement($.a.Group,{controlId:"payloadInput"},r.a.createElement($.a.Label,null,"Payload (optional)"),r.a.createElement($.a.Control,{as:"textarea",rows:5,disabled:this.state.scheduleDisabled,value:this.state.payload,onChange:this.onPayloadChange,isInvalid:!this.state.payloadValidated,isValid:this.state.payloadValidated}),r.a.createElement($.a.Control.Feedback,{type:"valid"},"Payload needs to be a valid JSON object."),r.a.createElement($.a.Control.Feedback,{type:"invalid"},"Payload needs to be a valid JSON object."));return r.a.createElement("div",null,r.a.createElement(Z,{ref:function(t){e.alert=t}}),r.a.createElement(Q.a,{show:this.state.visible,"aria-labelledby":"contained-modal-title-vcenter",centered:!0},r.a.createElement(Q.a.Body,null,r.a.createElement("div",{className:"dialog-content-left"},t,n,c,o,i)),r.a.createElement(Q.a.Footer,null,r.a.createElement(F.a,{variant:"secondary",onClick:this.close},"Cancel"),r.a.createElement(F.a,{variant:"success",onClick:this.schedule,disabled:this.state.submitDisabled},"Schedule"))))}}]),t}(n.Component);var te=Object(d.b)((function(e,t){return Object(m.a)({__projects:Object.keys(e.projects).sort()},e.projects)}),(function(e){return{}}))(ee),ae=function(e){function t(){var e,a;Object(g.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(D.a)(this,(e=Object(_.a)(t)).call.apply(e,[this].concat(r)))).state={visible:!1,text:""},a.no=function(){a.setState({visible:!1}),a.state.no&&a.state.no.fn&&a.state.no.fn()},a.yes=function(){a.state.yes&&a.state.yes.fn&&a.state.yes.fn(),a.setState({visible:!1})},a.show=function(e,t,n){a.setState({visible:!0,text:e,yes:t,no:n})},a}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e="secondary",t="primary",a="Cancel",n="Ok";return this.state.no&&(this.state.no.variant&&(e=this.state.no.variant),this.state.no.text&&(a=this.state.no.text)),this.state.yes&&(this.state.yes.variant&&(t=this.state.yes.variant),this.state.yes.text&&(n=this.state.yes.text)),r.a.createElement("div",null,r.a.createElement(Q.a,{show:this.state.visible,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,size:"sm"},r.a.createElement(Q.a.Body,null,r.a.createElement("div",{className:"dialog-content-center"},this.state.text)),r.a.createElement(Q.a.Footer,null,r.a.createElement(F.a,{variant:e,onClick:this.no},a),r.a.createElement(F.a,{variant:t,onClick:this.yes},n))))}}]),t}(n.Component),ne=function(e){function t(){var e,a;Object(g.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(D.a)(this,(e=Object(_.a)(t)).call.apply(e,[this].concat(r)))).showRemoveDialog=function(){var e=a.props,t={variant:"danger",text:"Remove",fn:function(){H(e.name).catch((function(e){setTimeout((function(){return a.alertDialog.show(e.message)}),250)}))}},n='Are you sure you want to remove project "'.concat(e.name,'"?');a.removeDialog.show(n,t)},a}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this,t=this.props;return r.a.createElement("div",{className:"project-list-item"},r.a.createElement(ae,{ref:function(t){e.removeDialog=t}}),r.a.createElement(Z,{ref:function(t){e.alertDialog=t}}),r.a.createElement(te,{provideController:function(t){return e.scheduleDialogCtl=t}}),r.a.createElement(W.a,null,r.a.createElement(W.a.Header,null,r.a.createElement("div",{className:"list-item"},r.a.createElement("div",{className:"item-panel"},r.a.createElement(F.a,{size:"sm",variant:"secondary",disabled:!this.props.connected,onClick:this.showRemoveDialog},r.a.createElement(L.i,null)," Remove")),r.a.createElement("strong",null,t.name))),r.a.createElement(W.a.Body,null,r.a.createElement("div",{className:"spider-list"},t.spiders.map((function(a){return r.a.createElement(F.a,{size:"sm",variant:"outline-secondary",disabled:!e.props.connected,key:a,onClick:function(){e.scheduleDialogCtl.show(t.name,a)}},r.a.createElement(L.b,null)," ",a)}))))))}}]),t}(n.Component);var re=Object(d.b)((function(e,t){return Object(m.a)({},e.projects[t.projectName],{connected:"BACKEND_OPENED"===e.backend.status})}),(function(e){return{}}))(ne),se=function(e){function t(){var e,a;Object(g.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(D.a)(this,(e=Object(_.a)(t)).call.apply(e,[this].concat(r)))).state={visible:!1,pushEnabled:!1},a.close=function(){a.setState({visible:!1})},a.show=function(){a.setState({visible:!0})},a.push=function(){if(!a.archivePromise)return setTimeout((function(){return a.alert.show("No file selected.")}),250),void a.close();a.archivePromise.then((function(e){return Y(e)})).then((function(){a.archivePromise=null})).catch((function(e){setTimeout((function(){return a.alert.show(e.message)}),250)})),a.close()},a.fileSelectorChange=function(e){var t=e.target.files;t.length&&(a.setState({pushEnabled:!0}),a.archivePromise=new Promise((function(e,a){var n=new FileReader;n.readAsBinaryString(t[0]),n.onload=function(){return e(btoa(n.result))},n.onerror=function(e){return a(e)}})))},a}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(Z,{ref:function(t){e.alert=t}}),r.a.createElement(Q.a,{show:this.state.visible,"aria-labelledby":"contained-modal-title-vcenter",centered:!0},r.a.createElement(Q.a.Body,null,r.a.createElement("div",{className:"dialog-content-center"},r.a.createElement("label",null,"Choose a project archive:"),r.a.createElement("input",{type:"file",id:"filePicker",accept:".zip",onChange:this.fileSelectorChange}))),r.a.createElement(Q.a.Footer,null,r.a.createElement(F.a,{variant:"secondary",onClick:this.close},"Cancel"),r.a.createElement(F.a,{variant:"primary",onClick:this.push,disabled:!this.state.pushEnabled},"Push"))))}}]),t}(n.Component),ce=function(e){function t(){return Object(g.a)(this,t),Object(D.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this,t=this.props.projects,a=r.a.createElement(W.a,null,r.a.createElement("div",{className:"list-empty"},"No projects."));return t.length&&(a=r.a.createElement("div",null,t.map((function(e){return r.a.createElement(re,{key:e,projectName:e})})))),r.a.createElement("div",{className:"col-md-8 col-md-offset-2"},r.a.createElement(se,{ref:function(t){e.dialog=t}}),r.a.createElement("h2",null,"Projects"),r.a.createElement("div",{className:"control-button-container"},r.a.createElement(F.a,{variant:"outline-secondary",size:"sm",disabled:!this.props.connected,onClick:function(){return e.dialog.show()}},r.a.createElement(L.f,null)," Push project")),a)}}]),t}(n.Component);var oe=Object(d.b)((function(e,t){return{projects:Object.keys(e.projects).sort(),connected:"BACKEND_OPENED"===e.backend.status}}),(function(e){return{}}))(ce),ie=a(102),le=a(159),ue=a.n(le),de=a(166),me=a(80),he=a(160),pe=a.n(he),Ee=a(101),be=a(161),fe=function(e){function t(){var e,a;Object(g.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(D.a)(this,(e=Object(_.a)(t)).call.apply(e,[this].concat(r)))).state={mounted:!1,text:" "},a.fetch=function(){fetch(a.props.url).catch((function(e){a.mounted&&a.setState({text:"Error fetching data from ".concat(a.props.url,": error")})})).then((function(e){return e.body.getReader()})).then((function(e){var t="";return e.read().then((function a(n){var r=n.done,s=n.value;return r?t:(t+=String.fromCharCode.apply(null,s),e.read().then(a))}))})).then((function(e){a.mounted&&(a.setState({text:e}),a.props.follow&&setTimeout(a.fetch,1e3))}))},a}return Object(k.a)(t,e),Object(T.a)(t,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){return r.a.createElement("div",{style:{height:500}},r.a.createElement(be.LazyLog,{extraLines:1,scrollToLine:1e17,enableSearch:this.props.enableSearch,text:this.state.text,caseInsensitive:this.props.caseInsensitive}))}}]),t}(n.Component),ve=function(e){switch(e){case"SCHEDULED":return"primary";case"PENDING":return"warning";case"RUNNING":return"success";case"CANCELED":return"warning";case"SUCCESSFUL":return"success";case"FAILED":return"danger";default:return"primary"}};function ye(e){var t=e.text,a=e.eventKey,n=e.fn,s=Object(Ee.b)(a,(function(e){n&&n(),e.preventDefault()}));return r.a.createElement("a",{href:"foo",onClick:s},t)}var je=function(e,t){var a=t?"err":"out";return"/get-log/data/".concat(e,".").concat(a)},ge=function(e){function t(){var e,a;Object(g.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(D.a)(this,(e=Object(_.a)(t)).call.apply(e,[this].concat(r)))).showCancelDialog=function(){var e=a.props,t={variant:"danger",text:"Yes",fn:function(){X(e.identifier).catch((function(e){setTimeout((function(){return a.alertDialog.show(e.message)}),250)}))}};a.cancelDialog.show("Are you sure you want to cancel the job?",t,{text:"No"})},a}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=z.a.unix(t.timestamp),n=a.tz(this.props.timezone).format("YYYY-MM-DD HH:mm:ss"),s=r.a.createElement("div",{className:"item-panel-button"},r.a.createElement(F.a,{variant:"outline-secondary",size:"sm",disabled:!this.props.connected,onClick:this.showCancelDialog},r.a.createElement(L.h,null)," Cancel")),c=null,o=null,i="out-".concat(t.identifier),l=null,u=null,d="err-".concat(t.identifier),m=!1;"RUNNING"===t.status&&(m=!0);o=r.a.createElement(ye,{eventKey:i,text:"Out Log",fn:function(){e.outLog.fetch()}}),u=r.a.createElement(ye,{eventKey:d,text:"Err Log",fn:function(){e.errLog.fetch()}}),c=r.a.createElement(me.a.Collapse,{eventKey:i},r.a.createElement("div",null,r.a.createElement("div",{className:"accordion-header"},"Out Log"),r.a.createElement("div",{style:{height:500}},r.a.createElement(fe,{ref:function(t){e.outLog=t},follow:m,enableSearch:!0,url:je(t.identifier,!1),caseInsensitive:!0})))),l=r.a.createElement(me.a.Collapse,{eventKey:d},r.a.createElement("div",null,r.a.createElement("div",{className:"accordion-header"},"Err Log"),r.a.createElement("div",{style:{height:500}},r.a.createElement(fe,{ref:function(t){e.errLog=t},follow:m,enableSearch:!0,url:je(t.identifier,!0),caseInsensitive:!0})))),"COMPLETED"===this.props.jobList&&(s=null,t.outLog||(o=null,c=null),t.errLog||(u=null,l=null)),"ACTIVE"===this.props.jobList&&"RUNNING"!==t.status&&(o=null,c=null,u=null,l=null);var h=null,p=null,E="payload-".concat(t.identifier),b=JSON.stringify(JSON.parse(t.payload),null,4),f=pe.a.highlight("json",b).value;"{}"!==b&&(p=r.a.createElement(ye,{eventKey:E,text:"Payload"}),h=r.a.createElement(me.a.Collapse,{eventKey:E},r.a.createElement("div",null,r.a.createElement("div",{className:"accordion-header"},"Payload"),r.a.createElement("pre",{className:"hljs"},r.a.createElement("code",{dangerouslySetInnerHTML:{__html:f}})))));var v=r.a.createElement("div",{className:"item-panel",title:n},o,o&&(u||p)?" | ":"",u,u&&p?" | ":"",p,s),y="";return""!==t.description&&(y="[".concat(t.description,"]")),r.a.createElement(ie.a.Item,null,r.a.createElement(ae,{ref:function(t){e.cancelDialog=t}}),r.a.createElement(Z,{ref:function(t){e.alertDialog=t}}),r.a.createElement(me.a,null,r.a.createElement("div",{className:"list-group-item-body"},r.a.createElement("div",{className:"list-item"},r.a.createElement("div",{className:"item-panel",title:n},a.fromNow()),r.a.createElement(de.a,{variant:ve(t.status)},t.status),r.a.createElement("strong",null," ",t.spider," ",y)," (",t.project,")"),r.a.createElement("div",{className:"list-item-secondary"},v,"Scheduled by ",O(t.actor)," to run ",t.schedule,".")),h,c,l))}}]),t}(n.Component);var Oe=Object(d.b)((function(e,t){return Object(m.a)({},e.jobs[t.jobList][t.jobId],{timezone:e.status.timezone,connected:"BACKEND_OPENED"===e.backend.status})}),(function(e){return{}}))(ge),Ce=function(e){function t(){return Object(g.a)(this,t),Object(D.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this,t=this.props.jobs,a=this.props.match.params.status,n=r.a.createElement(W.a,null,r.a.createElement("div",{className:"list-empty"},"No jobs."));t.length&&(n=r.a.createElement(ie.a,null,t.map((function(e){return r.a.createElement(Oe,{key:e,jobId:e,jobList:a.toUpperCase()})}))));var s=r.a.createElement("div",{className:"control-button-container"},r.a.createElement(F.a,{variant:"outline-secondary",size:"sm",disabled:!this.props.connected,onClick:function(){return e.scheduleDialogCtl.show()}},r.a.createElement(L.c,null)," Schedule a job"));return"completed"===a&&(s=null),r.a.createElement("div",{className:"col-md-8 col-md-offset-2"},r.a.createElement(te,{provideController:function(t){return e.scheduleDialogCtl=t}}),r.a.createElement("h2",null,O(a)," Jobs"),s,r.a.createElement("div",{className:"content-container"},n))}}]),t}(n.Component);var we=Object(d.b)((function(e,t){var a=t.match.params.status.toUpperCase(),n=[];return a in e.jobs&&(n=Object.keys(e.jobs[a]).map((function(t){return e.jobs[a][t]})).sort(ue()("-timestamp")).map((function(e){return e.identifier}))),{jobs:n,connected:"BACKEND_OPENED"===e.backend.status}}),(function(e){return{}}))(Ce),Se=function(e){function t(){return Object(g.a)(this,t),Object(D.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"col-md-6 col-md-offset-3"},r.a.createElement("div",{className:"dashboard-content"},r.a.createElement("div",{className:"text-summary"},r.a.createElement("div",null,"Scrapy-Do has been developed by Lukasz Janyst"),r.a.createElement("div",null,"and is distributed under the 3-Clause BSD License.")),r.a.createElement("div",{className:"text-summary"},r.a.createElement("div",null,"It directly uses on the following packages either at runtime or for development:")),r.a.createElement("div",{className:"text-summary"},r.a.createElement("div",{className:"jobs-summary"},r.a.createElement(J.a,{striped:!0,bordered:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"License"))),r.a.createElement("tbody",null,[{name:"python",website:"https://www.python.org/",license:"PSFL"},{name:"scrapy",website:"https://scrapy.org/",license:"BSD"},{name:"twisted",website:"https://twistedmatrix.com/trac/",license:"MIT"},{name:"pyOpenSSL",website:"https://pyopenssl.org/",license:"Apache 2.0"},{name:"psutil",website:"https://github.com/giampaolo/psutil",license:"BSD"},{name:"python-dateutil",website:"https://dateutil.readthedocs.io/",license:"BSD"},{name:"schedule",website:"https://github.com/dbader/schedule",license:"MIT"},{name:"pem",website:"https://pem.readthedocs.io/",license:"MIT"},{name:"tabulate",website:"https://github.com/astanin/python-tabulate",license:"MIT"},{name:"requests",website:"http://python-requests.org/",license:"Apache 2.0"},{name:"autobahn",website:"http://crossbar.io/autobahn",license:"MIT"},{name:"tzlocal",website:"https://github.com/regebro/tzlocal",license:"MIT"},{name:"bootstrap",website:"https://getbootstrap.com/",license:"MIT"},{name:"highlight.js",website:"https://highlightjs.org/",license:"BSD"},{name:"moment-timezone",website:"http://momentjs.com/timezone/",license:"MIT"},{name:"prop-types",website:"https://facebook.github.io/react/",license:"MIT"},{name:"react",website:"https://github.com/facebook/react",license:"MIT"},{name:"react-dom",website:"https://github.com/facebook/react",license:"MIT"},{name:"react-icons",website:"https://github.com/react-icons/react-icons#readme",license:"MIT"},{name:"Font Awesome",website:"https://fontawesome.com/",license:"CC BY 4.0"},{name:"react-lazylog",website:"https://github.com/mozilla-frontend-infra/react-lazylog#readme",license:"MPL-2.0"},{name:"redux",website:"http://redux.js.org/",license:"MIT"},{name:"react-redux",website:"https://github.com/reduxjs/react-redux",license:"MIT"},{name:"react-router-dom",website:"https://github.com/ReactTraining/react-router#readme",license:"MIT"},{name:"rect-router-bootstrap",website:"https://github.com/react-bootstrap/react-router-bootstrap",license:"Apache 2.0"},{name:"react-scripts",website:"https://github.com/facebook/create-react-app#readme",license:"MIT"},{name:"sort-by",website:"https://github.com/kvnneff/sort-by#readme",license:"MIT"},{name:"node.js",website:"https://nodejs.org/en/",license:"MIT"},{name:"docutils",website:"http://docutils.sourceforge.net/",license:"multiple"},{name:"pygments",website:"http://pygments.org/",license:"BSD"},{name:"pytest",website:"https://docs.pytest.org/en/latest/",license:"MIT"},{name:"pytest-cov",website:"https://github.com/pytest-dev/pytest-cov",license:"BSD"},{name:"pytest-flake8",website:"https://github.com/tholo/pytest-flake8",license:"BSD"},{name:"sphinx",website:"http://sphinx-doc.org/",license:"BSD"}].map((function(e){return r.a.createElement("tr",{key:e.name},r.a.createElement("td",null,r.a.createElement("a",{href:e.website},e.name)),r.a.createElement("td",null,e.license))}))))))))}}]),t}(n.Component);function Ne(e){return r.a.createElement("div",{className:"col-md-8 col-md-offset-2"},r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("div",{style:{margin:"3em"}},r.a.createElement(L.e,{size:300,color:"DimGrey"})),r.a.createElement("h3",null,"This is not what you're looking for.")))}var Te=function(e){function t(){return Object(g.a)(this,t),Object(D.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(x,null),r.a.createElement("div",{className:"content"},r.a.createElement(B,null),r.a.createElement(I.g,null,r.a.createElement(I.d,{exact:!0,path:"/",component:G}),r.a.createElement(I.d,{exact:!0,path:"/dashboard",component:G}),r.a.createElement(I.d,{exact:!0,path:"/project-list",component:oe}),r.a.createElement(I.d,{path:"/job-list/:status",component:we}),r.a.createElement(I.d,{exact:!0,path:"/about",component:Se}),r.a.createElement(I.d,{component:Ne}))))}}]),t}(n.Component);a.d(t,"store",(function(){return De}));var De=Object(u.c)(Object(u.b)({backend:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"BACKEND_STATUS_SET":return Object(m.a)({},e,{status:t.status});case"BACKEND_COUNTDOWN_SET":return Object(m.a)({},e,{countdown:t.countdown});default:return e}},status:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DAEMON_STATUS_SET":return Object(m.a)({},e,{memoryUsage:t.memoryUsage,cpuUsage:t.cpuUsage,time:t.time,timezone:t.timezone,hostname:t.hostname,uptime:t.uptime,daemonVersion:t.daemonVersion});case"PROJECTS_STATUS_SET":return Object(m.a)({},e,{projects:t.projects,spiders:t.spiders});case"JOBS_STATUS_SET":return Object(m.a)({},e,{jobsRun:t.jobsRun,jobsSuccessful:t.jobsSuccessful,jobsFailed:t.jobsFailed,jobsCanceled:t.jobsCanceled,jobsScheduled:t.jobsScheduled});default:return e}},projects:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PROJECT_PUSH":return Object(m.a)({},e,Object(b.a)({},t.name,{name:t.name,spiders:t.spiders}));case"PROJECT_REMOVE":var a=Object.assign(e);return delete a[t.name],a;case"PROJECT_LIST_SET":return t.projects.reduce((function(e,t){return e[t.name]=t,e}),{});default:return e}},jobs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"JOB_LIST_SET":var a=t.jobs.reduce((function(e,t){return e[t.identifier]=t,e}),{});return Object(m.a)({},e,Object(b.a)({},t.status,a));case"JOB_REMOVE":return y(e,t.jobId);case"JOB_UPDATE":var n=y(e,t.job.identifier),r=j(t.job.status);return n[r][t.job.identifier]=t.job,n;default:return e}}}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());N.addEventListener((function(e,t){e===S.CONNECTING?De.dispatch(h("BACKEND_CONNECTING")):e===S.OPENED?De.dispatch(h("BACKEND_OPENED")):e===S.CLOSED?De.dispatch(h("BACKEND_CLOSED")):e===S.COUNTDOWN&&De.dispatch({type:"BACKEND_COUNTDOWN_SET",countdown:t})})),N.addEventListener((function(e,t){var a,n,r;if(e===S.MSG_RECEIVED)switch(t.type){case"DAEMON_STATUS":De.dispatch({type:"DAEMON_STATUS_SET",memoryUsage:(r=t).memoryUsage,cpuUsage:r.cpuUsage,time:r.time,timezone:r.timezone,hostname:r.hostname,uptime:r.uptime,daemonVersion:r.daemonVersion});break;case"PROJECTS_STATUS":De.dispatch(function(e){return{type:"PROJECTS_STATUS_SET",projects:e.projects,spiders:e.spiders}}(t));break;case"JOBS_STATUS":De.dispatch(function(e){return{type:"JOBS_STATUS_SET",jobsRun:e.jobsRun,jobsSuccessful:e.jobsSuccessful,jobsFailed:e.jobsFailed,jobsCanceled:e.jobsCanceled,jobsScheduled:e.jobsScheduled}}(t));break;case"PROJECT_LIST":De.dispatch({type:"PROJECT_LIST_SET",projects:t.projects});break;case"PROJECT_PUSH":De.dispatch((a=t.name,n=t.spiders,{type:"PROJECT_PUSH",name:a,spiders:n}));break;case"PROJECT_REMOVE":De.dispatch(function(e){return{type:"PROJECT_REMOVE",name:e}}(t.name));break;case"JOB_LIST":De.dispatch(function(e,t){return{type:"JOB_LIST_SET",status:e,jobs:t}}(t.status,t.jobs));break;case"JOB_UPDATE":De.dispatch({type:"JOB_UPDATE",job:t.job});break;case"JOB_REMOVE":De.dispatch({type:"JOB_REMOVE",jobId:t.jobId})}})),c.a.render(r.a.createElement(d.a,{store:De},r.a.createElement(l.BrowserRouter,null,r.a.createElement(Te,null))),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");o?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):i(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):i(e)}))}}()}},[[168,1,2]]]);
//# sourceMappingURL=main.79a16d2d.chunk.js.map