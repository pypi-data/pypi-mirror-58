(window["webpackJsonpstreamlit-browser"]=window["webpackJsonpstreamlit-browser"]||[]).push([[28],{2527:function(t,e,a){},2690:function(t,e,a){"use strict";a.r(e);var r=a(62),n=a(27),i=a.n(n),s=a(46),c=a(7),h=a(10),o=a(12),u=a(11),d=a(13),g=a(0),f=a.n(g),p=a(50),l=a(93),v=a(14),b=a(2494),m=a.n(b),w=a(1760),O=(a(2527),{DATAFRAME_INDEX:"(index)"}),j="source",x=38,y=200,D=20,V=new Set(["datetimeIndex","float_64Index","int_64Index","rangeIndex","timedeltaIndex","uint_64Index"]),k=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(o.a)(this,Object(u.a)(e).call(this,t))).vegaView=void 0,a.defaultDataName=j,a.element=null,a.getChartDimensions=function(t){return{width:0===t?a.props.width-x:t,height:a.props.height?a.props.height:y}},a.getChartPadding=function(t){return void 0===t?{top:0,left:0,right:0,bottom:D}:"number"===typeof t?{top:t,left:t,right:t,bottom:Math.max(t,D)}:void 0!==t.bottom?(t.bottom=Math.max(t.bottom,D),t):void 0===t.bottom?(t.bottom=D,t):0},a.state={error:void 0},a}return Object(d.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this;if(this.state.error)throw this.state.error;return f.a.createElement("div",{className:"stVegaLiteChart",ref:function(e){return t.element=e}})}},{key:"componentDidMount",value:function(){var t=Object(s.a)(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.createView();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),this.setState({error:t.t0});case 8:case"end":return t.stop()}},t,this,[[0,5]])}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(i.a.mark(function t(e){var a,n,s,c,h,o,u,d,g,f,p,l,b,m,w,O,j,x,y;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.element,n=this.props.element,s=a.get("spec"),c=n.get("spec"),this.vegaView&&s===c&&e.width===this.props.width&&e.height===this.props.height){t.next=15;break}return Object(v.c)("Vega spec changed."),t.prev=6,t.next=9,this.createView();case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(6),this.setState({error:t.t0});case 14:return t.abrupt("return");case 15:for(h=a.get("data"),o=n.get("data"),(h||o)&&this.updateData(this.defaultDataName,h,o),u=A(a)||{},d=A(n)||{},g=0,f=Object.entries(d);g<f.length;g++)p=f[g],l=Object(r.a)(p,2),b=l[0],m=l[1],w=b||this.defaultDataName,O=u[w],this.updateData(w,O,m);for(j=0,x=Object.keys(u);j<x.length;j++)y=x[j],d.hasOwnProperty(y)||y===this.defaultDataName||this.updateData(y,null,null);this.vegaView.resize().runAsync();case 23:case"end":return t.stop()}},t,this,[[6,11]])}));return function(e){return t.apply(this,arguments)}}()},{key:"updateData",value:function(t,e,a){if(!this.vegaView)throw new Error("Chart has not been drawn yet");if(a&&a.get("data"))if(e&&e.get("data")){var n=Object(p.i)(e.get("data")),i=Object(r.a)(n,2),s=i[0],c=i[1],h=Object(p.i)(a.get("data")),o=Object(r.a)(h,2),u=o[0];if(function(t,e,a,r,n,i){if(a!==i)return!1;if(e>n)return!1;if(0===e)return!1;var s=t.get("data"),c=r.get("data"),h=i-1,o=e-1;if(Object(p.h)(s,h,0)!==Object(p.h)(c,h,0)||Object(p.h)(s,h,o)!==Object(p.h)(c,h,o))return!1;return!0}(e,s,c,a,u,o[1]))s<u&&this.vegaView.insert(t,C(a,s));else{var d=w.changeset().remove(w.truthy).insert(C(a));this.vegaView.change(t,d),Object(v.c)("Had to clear the ".concat(t," dataset before inserting data through Vega view."))}}else this.vegaView.insert(t,C(a));else this.vegaView._runtime.data.hasOwnProperty(t)&&this.vegaView.remove(t,w.truthy)}},{key:"createView",value:function(){var t=Object(s.a)(i.a.mark(function t(){var e,a,n,s,c,h,o,u,d,g,f,p,l,b,w,O,x;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(Object(v.c)("Creating a new Vega view."),this.element){t.next=3;break}throw Error("Element missing.");case 3:if(this.vegaView&&this.vegaView.finalize(),e=this.props.element,a=JSON.parse(e.get("spec")),n=this.getChartDimensions(a.width),s=n.width,c=n.height,a.width=s,a.height=c,a.padding=this.getChartPadding(a.padding),a.padding||(a.padding={}),null==a.padding.bottom&&(a.padding.bottom=20),!a.datasets){t.next=14;break}throw new Error("Datasets should not be passed as part of the spec");case 14:return t.next=16,m()(this.element,a);case 16:if(h=t.sent,o=h.vgSpec,u=h.view,d=N(e),1===(g=d?Object.keys(d):[]).length?this.defaultDataName=g[0]:0===g.length&&o.data&&(this.defaultDataName=j),(f=E(e))&&u.insert(this.defaultDataName,f),d)for(p=0,l=Object.entries(d);p<l.length;p++)b=l[p],w=Object(r.a)(b,2),O=w[0],x=w[1],u.insert(O,x);return this.vegaView=u,t.next=28,u.runAsync();case 28:this.vegaView.resize().runAsync();case 29:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}]),e}(f.a.PureComponent);function E(t){var e=t.get("data");return e?C(e):null}function N(t){var e=A(t);if(null==e)return null;for(var a={},n=0,i=Object.entries(e);n<i.length;n++){var s=i[n],c=Object(r.a)(s,2),h=c[0],o=c[1];a[h]=C(o)}return a}function A(t){if(!t.get("datasets")||t.get("datasets").isEmpty())return null;var e={};return t.get("datasets").forEach(function(t,a){if(t){var r=t.get("hasName")?t.get("name"):null;e[r]=t.get("data")}}),e}function C(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!t.get("data"))return[];if(!t.get("index"))return[];if(!t.get("columns"))return[];for(var a=[],n=Object(p.i)(t.get("data")),i=Object(r.a)(n,2),s=i[0],c=i[1],h=t.get("index").get("type"),o=V.has(h),u=e;u<s;u++){var d={};o&&(d[O.DATAFRAME_INDEX]=Object(p.g)(t.get("index"),0,u));for(var g=0;g<c;g++)d[Object(p.g)(t.get("columns"),0,g)]=Object(p.h)(t.get("data"),g,u);a.push(d)}return a}var I=function(t){function e(){return Object(c.a)(this,e),Object(o.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this.props,e=t.element,a=t.width;return f.a.createElement(l.a,{width:a},function(t){var a=t.width,r=t.height;return f.a.createElement(k,{element:e,width:a,height:r})})}}]),e}(f.a.Component);a.d(e,"default",function(){return I})}}]);
//# sourceMappingURL=28.7da486ab.chunk.js.map