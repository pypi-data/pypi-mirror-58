.\" Automatically generated by Pandoc 2.7.3
.\"
.TH "MKVTOMP4" "1" "November 17, 2019" "" ""
.hy
.SH NAME
.PP
mkvtomp4.py - convert H.264 mkv files to mp4 files playable on the PS3
.SH SYNOPSIS
.PP
\f[I]mkvtomp4.py\f[R] OPTIONS [--] <mkvfile>
.PP
\f[I]mkvtomp4.py\f[R] --correct-profile-only [--] <rawh264file>
.SH DESCRIPTION
.PP
Uses existing tools to convert troublesome mkv files to mp4, that is
playable on the PS3.
The conversion does not re-encode H.264 video.
If the H.264 profile level is not supported by the PS3, we rewrite just
some profile level information.
The default value is 4.1, but it can be set with
\f[C]--profile-level=4.0\f[R], etc.
The conversion only re-encodes audio if it doesn\[cq]t already use AAC.
The resulting mp4 will be playable on the Sony PS3, and similar devices.
Tested on profile levels 3.x and 4.x,
.PP
Note that the PS4 Media Player has better support for mkv than mp4
(subtitles work only on mkv).
.PP
We depend on: \f[I]mkvtoolnix\f[R] and GPAC\[cq]s \f[I]MP4Box\f[R] for
the conversion.
\f[I]ffmpeg\f[R] is only required if doing audio transcoding and
subtitles.
.SH OPTIONS
.TP
.B -o, --output=<outfile>
Put the completed mp4 into \f[C]<outfile>\f[R].
.TP
.B --keep-temp-files
Keep all temporary files created while converting.
.TP
.B -v, --verbose
Print info about what is happening.
.TP
.B -n, --dry-run
Don\[cq]t run any commands, but print them in a shellquoted format that
can be safely copy-pasted by the user.
.TP
.B --mp4box=<mp4box>
Use \f[C]<mp4box>\f[R] as the MP4Box command.
.TP
.B --ffmpeg=<ffmpeg>
Use \f[C]<ffmpeg>\f[R] as the ffmpeg command.
.TP
.B --mkvinfo=<mkvinfo>
Use \f[C]<mkvinfo>\f[R] as the mkvinfo command.
.TP
.B --mkvextract=<mkvextract>
Use \f[C]<mkvextract>\f[R] as the mkvextract command.
.TP
.B --video-track=<video_track>
Use \f[C]<video_track>\f[R] from the mkv file instead of trying to parse
it.
.TP
.B --hint, --no-hint
Add info to the mp4 to make it easier to stream over the network.
.TP
.B --audio-track=<audio_track>
Use \f[C]<audio_track>\f[R] from the mkv file instead of trying to parse
it.
.TP
.B --audio-delay-ms=<delay_ms>
When importing the audio track, delay by \f[C]<delay_ms>\f[R]
milliseconds.
e.g., \f[C]--audio-delay-ms\f[R]=\f[C]1000\f[R] delays by 1 second.
Only supported by mp4box.
.TP
.B --audio-bitrate=<bitrate>
If/When converting audio, use the given bitrate.
e.g., \f[C]128\f[R].
.TP
.B --audio-channels=<channels>
If/When converting audio, use \f[C]<channels>\f[R] channels in the
output.
e.g., \f[C]5.1\f[R].
.TP
.B --audio-codec=<codec>
If/When converting audio, convert to \f[C]<codec>\f[R].
Default is \f[C]aac\f[R].
This should be something supported by \f[I]ffmpeg\f[R].
.TP
.B --audio-lang=<language>
The 3-letter code for the language of the audio track.
Only needs to be set if not already specified in the source.
.TP
.B --subtitle-track=<subtitle_track>
Use \f[C]<subtitle_track>\f[R] from the mkv file instead of trying to
parse it.
.TP
.B --subtitle-lang=<language>
The 3-letter code for the language of the subtitle track.
Only needs to be set if not already specified in the source.
.TP
.B --subtitle-default, --subtitle-no-default
Specify whether playback should use the subtitles by default.
.TP
.B --correct-profile-only
Only correct the profile.
.TP
.B --profile-level=<profile-level>
Use this profile if we need to rewrite the video stream\[cq]s H.264
profile level, instead of the default, \[lq]4.1\[rq].
.TP
.B --force-profile-level, --no-force-profile-level
Rewrite the video stream\[cq]s H.264 profile level, even if the existing
profile is less than or equal to the new value.
Or not.
.TP
.B --stop-before-extract-video
Exit before extracting video from \f[C]<mkvfile>\f[R].
.TP
.B --stop-before-correct-profile
Exit before correcting profile of raw H.264 stream.
.TP
.B --stop-before-extract-audio
Exit before extracting audio from \f[C]<mkvfile>\f[R].
.TP
.B --stop-before-convert-audio
Exit before converting audio previously extracted.
This will stop even if the audio does not need to be converted.
.TP
.B --stop-before-extract-sub
Exit before extracting subtitles from \f[C]<mkvfile>\f[R].
.TP
.B --stop-before-mp4
Exit before adding audio and video to the mp4 container.
.TP
.B --stop-before-add-sub
Exit before adding subtitles to the mp4.
.TP
.B <mkvfile>
The Matroska (.mkv) file you wish to convert.
.TP
.B <rawh264file>
The raw H.264 stream file that will have its profile corrected for use
on the PS3.
.SH AUTHOR
.PP
Gavin Beatty <public@gavinbeatty.com>
.SH RESOURCES
.PP
Website: <http://github.com/gavinbeatty/mkvtomp4/>
.SH REPORTING BUGS
.PP
Please report all bugs and wishes to <public@gavinbeatty.com>
.SH COPYING
.PP
mkvtomp4 Copyright (c) 2012, 2013, 2019 Gavin Beatty,
<public@gavinbeatty.com>
.PP
Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
\[lq]Software\[rq]), to deal in the Software without restriction,
including without limitation the rights to use, copy, modify, merge,
publish, distribute, sublicense, and/or sell copies of the Software, and
to permit persons to whom the Software is furnished to do so, subject to
the following conditions:
.PP
The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.
.PP
THE SOFTWARE IS PROVIDED \[lq]AS IS\[rq], WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
.SH AUTHORS
Gavin Beatty.
