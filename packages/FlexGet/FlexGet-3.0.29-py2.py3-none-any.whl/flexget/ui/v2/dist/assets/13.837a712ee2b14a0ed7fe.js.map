{"version":3,"sources":["webpack:///./src/common/inputs/formik/TextField.tsx","webpack:///./src/plugins/log/Header.tsx","webpack:///./src/plugins/log/types.ts","webpack:///./src/plugins/log/LogTable.tsx","webpack:///./src/plugins/log/Log.tsx"],"names":["TextField","name","props","useField","field","touched","error","helperText","LogLevel","wrapper","theme","css","breakpoints","up","filterWrapper","filterField","Header","readyState","connect","disconnect","clear","useState","anchorEl","setAnchorEl","useMemo","ReadyState","Open","onClick","Icon","Stop","label","heading","Connecting","CircularProgress","disabled","Closed","PlayArrow","handleMenuClose","useCallback","undefined","handleMenuOpen","event","currentTarget","useFormikContext","values","submitForm","debouncedValues","useDebounce","useEffect","Object","Typography","variant","color","FilterList","id","IconButton","MoreVert","Menu","open","onClose","MenuItem","type","ListItemIcon","ClearAll","hex","palette","table","LogTable","messages","useTheme","cssString","cssMap","Error","Critical","Warning","height","actualWidth","width","actualHeight","rowCount","length","rowHeight","headerHeight","rowGetter","index","rowClassName","logLevel","dataKey","flexGrow","LogPage","useInjectPageTitle","useMergeState","lines","query","options","setOptions","queryString","stringify","useFlexgetStream","elevation","initialValues","onSubmit"],"mappings":"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","file":"13.837a712ee2b14a0ed7fe.js","sourcesContent":["import React from 'react';\nimport BaseTextField from '@material-ui/core/TextField';\nimport { useField } from 'formik';\nconst TextField = ({ name, ...props }) => {\n    const [field, { touched, error }] = useField(name);\n    return <BaseTextField error={touched && !!error} helperText={error} {...field} {...props}/>;\n};\nexport default TextField;\n","import React, { useState, useCallback, useMemo, useEffect, } from 'react';\nimport { useFormikContext } from 'formik';\nimport { Typography, IconButton, Menu, MenuItem, ListItemIcon, CircularProgress, } from '@material-ui/core';\nimport { css } from '@emotion/core';\nimport { Spacer } from 'common/styles';\nimport TextField from 'common/inputs/formik/TextField';\nimport { PlayArrow, Stop, FilterList, MoreVert, ClearAll } from '@material-ui/icons';\nimport { ReadyState } from 'core/api';\nimport { useDebounce } from 'utils/hooks';\nexport const wrapper = (theme) => css `\n  display: block;\n  ${theme.breakpoints.up('sm')} {\n    display: flex;\n    align-items: baseline;\n  }\n`;\nexport const filterWrapper = css `\n  display: flex;\n  align-items: center;\n`;\nexport const filterField = css `\n  margin-left: 1rem;\n  margin-right: 1rem;\n`;\nconst Header = ({ readyState, connect, disconnect, clear }) => {\n    const [anchorEl, setAnchorEl] = useState();\n    const helperText = 'Supports operators and, or, (), and \"str\"';\n    const stateMap = useMemo(() => ({\n        [ReadyState.Open]: {\n            onClick: disconnect,\n            Icon: Stop,\n            label: 'Stop',\n            heading: 'Streaming',\n        },\n        [ReadyState.Connecting]: {\n            label: 'Start',\n            Icon: CircularProgress,\n            heading: 'Connecting',\n            disabled: true,\n        },\n        [ReadyState.Closed]: {\n            onClick: connect,\n            Icon: PlayArrow,\n            label: 'Start',\n            heading: 'Disconnected',\n        },\n    }), [connect, disconnect]);\n    const { onClick, Icon, heading, label, disabled = false } = stateMap[readyState];\n    const handleMenuClose = useCallback(() => setAnchorEl(undefined), []);\n    const handleMenuOpen = useCallback((event) => setAnchorEl(event.currentTarget), []);\n    const { values, submitForm } = useFormikContext();\n    const debouncedValues = useDebounce(values);\n    useEffect(() => {\n        submitForm();\n    }, [...Object.values(debouncedValues), submitForm]); // eslint-disable-line react-hooks/exhaustive-deps\n    return (<div css={wrapper}>\n      <div>\n        <Typography variant=\"h6\">Server Log</Typography>\n        <Typography variant=\"subtitle1\" color=\"textSecondary\">\n          {heading}\n        </Typography>\n      </div>\n      <Spacer />\n      <div css={filterWrapper}>\n        <FilterList />\n        <TextField css={filterField} id=\"query\" name=\"query\" label=\"Filter\" helperText={helperText}/>\n        <IconButton onClick={handleMenuOpen}>\n          <MoreVert />\n        </IconButton>\n      </div>\n      <Menu id=\"log-menu\" anchorEl={anchorEl} open={!!anchorEl} onClose={handleMenuClose}>\n        <MenuItem>\n          <TextField id=\"lines\" name=\"lines\" label=\"Max Lines\" type=\"number\"/>\n        </MenuItem>\n        <MenuItem onClick={clear}>\n          <ListItemIcon>\n            <ClearAll />\n          </ListItemIcon>\n          Clear\n        </MenuItem>\n        <MenuItem onClick={onClick} disabled={disabled}>\n          <ListItemIcon>\n            <Icon />\n          </ListItemIcon>\n          {label}\n        </MenuItem>\n      </Menu>\n    </div>);\n};\nexport default Header;\n","export var LogLevel;\n(function (LogLevel) {\n    LogLevel[\"Trace\"] = \"TRACE\";\n    LogLevel[\"Debug\"] = \"DEBUG\";\n    LogLevel[\"Info\"] = \"INFO\";\n    LogLevel[\"Success\"] = \"SUCCESS\";\n    LogLevel[\"Warning\"] = \"WARNING\";\n    LogLevel[\"Error\"] = \"ERROR\";\n    LogLevel[\"Critical\"] = \"CRITICAL\";\n})(LogLevel || (LogLevel = {}));\n","import React from 'react';\nimport { AutoSizer, Column, Table } from 'react-virtualized';\nimport 'react-virtualized/styles.css';\nimport { css, ClassNames } from '@emotion/core';\nimport { useTheme } from '@material-ui/core';\nimport { LogLevel } from 'plugins/log/types';\nconst color = (theme, hex) => theme.palette.type === 'light'\n    ? css `\n        background-color: ${hex};\n      `\n    : css `\n        color: ${hex};\n      `;\nconst table = css `\n  font-size: 1rem;\n`;\nconst LogTable = ({ messages }) => {\n    const theme = useTheme();\n    return (<ClassNames>\n      {({ css: cssString }) => {\n        const cssMap = {\n            [LogLevel.Error]: cssString(color(theme, '#f2dede')),\n            [LogLevel.Critical]: cssString(color(theme, '#f2dede')),\n            [LogLevel.Warning]: cssString(color(theme, '#fcf8e3')),\n        };\n        return (<AutoSizer>\n            {({ height, width }) => {\n            let actualWidth = width;\n            let actualHeight = height;\n            if (process.env.NODE_ENV === 'test') {\n                actualWidth = window.innerWidth;\n                actualHeight = window.innerHeight;\n            }\n            return (<Table css={table} rowCount={messages.length} rowHeight={20} headerHeight={50} width={actualWidth} height={actualHeight} rowGetter={({ index }) => messages[index]} rowClassName={({ index }) => cssMap[messages[index]?.logLevel]}>\n                  <Column label=\"Time\" dataKey=\"timestamp\" width={100}/>\n                  <Column label=\"Level\" dataKey=\"logLevel\" width={100}/>\n                  <Column label=\"Plugin\" dataKey=\"plugin\" width={100}/>\n                  <Column label=\"Task\" dataKey=\"task\" width={100}/>\n                  <Column label=\"Message\" dataKey=\"message\" width={100} flexGrow={1}/>\n                </Table>);\n        }}\n          </AutoSizer>);\n    }}\n    </ClassNames>);\n};\nexport default LogTable;\n","import React from 'react';\nimport { Formik } from 'formik';\nimport { hot } from 'react-hot-loader/root';\nimport { css } from '@emotion/core';\nimport { PaperWrapper } from 'common/styles';\nimport { useInjectPageTitle } from 'core/layout/AppBar/hooks';\nimport { useFlexgetStream } from 'core/api';\nimport { useMergeState } from 'utils/hooks';\nimport { stringify } from 'qs';\nimport Header from './Header';\nimport LogTable from './LogTable';\nconst wrapper = css `\n  width: initial;\n  flex: 1;\n`;\nconst LogPage = () => {\n    useInjectPageTitle('Log');\n    const [options, setOptions] = useMergeState({\n        lines: 200,\n        query: '',\n    });\n    const queryString = stringify(options);\n    const [{ readyState, messages }, { connect, disconnect, clear }] = useFlexgetStream(`/server/log?${queryString}`);\n    return (<PaperWrapper elevation={4}>\n      <Formik initialValues={options} onSubmit={values => setOptions(values)}>\n        <Header readyState={readyState} connect={connect} disconnect={disconnect} clear={clear}/>\n      </Formik>\n      <div css={wrapper}>\n        <LogTable messages={messages}/>\n      </div>\n    </PaperWrapper>);\n};\nexport default hot(LogPage);\n"],"sourceRoot":""}