---

- name: Clone repository CompaniesService
  git:
    repo: git@github.com:JoseSalgado1024/companies-service.git
    force: yes
    version: master
    dest: src/companies-service

- name: Create & Install Companies Service
  command: docker-compose -f src/companies-service/docker-compose.yml up -d --force-recreate
  register: pir 


# - name: Lazy validation (UnitTest)
#   command: docker-compose -f src/companies-service/docker-compose.yml exec app bash -c "python -m unittest tests.UnitTests" 
#   register: lv_unit

# - name: Lazy validation (ServiceTest)
#   command: docker-compose -f src/companies-service/docker-compose.yml exec app bash -c "python -m unittest tests.ServiceTests" 
#   register: lv_service

- debug:
   msg: "Companies service is installed."
  when:  pir.rc == 0

- debug:
   msg: "Companies installation fails. ErrCode: {{ pir.rc }}"
  when:  pir.rc > 0
  