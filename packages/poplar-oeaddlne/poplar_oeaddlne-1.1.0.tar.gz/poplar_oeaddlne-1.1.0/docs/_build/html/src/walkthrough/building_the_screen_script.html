

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building the Screen Script &mdash; poplar_oeaddlne  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Making an Extender Module" href="making_the_module.html" />
    <link rel="prev" title="Building the View Script" href="building_the_view_script.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> poplar_oeaddlne
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../walkthrough.html">Walkthrough</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="building_the_view_script.html">Building the View Script</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Building the Screen Script</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#import-accpac-and-scaffold">Import accpac and Scaffold</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implement-the-onafter-call">Implement the onAfter call</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-parameters">Add Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="making_the_module.html">Making an Extender Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="adding_custom_tables.html">Custom Tables for Item Mappings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../OE0500_oe_add_line.html">Add OE Line - View Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OE1100_oe_add_line.html">Add OE Line - Screen Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Resources</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">poplar_oeaddlne</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../walkthrough.html">Walkthrough</a> &raquo;</li>
        
      <li>Building the Screen Script</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/src/walkthrough/building_the_screen_script.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="building-the-screen-script">
<h1>Building the Screen Script<a class="headerlink" href="#building-the-screen-script" title="Permalink to this headline">¶</a></h1>
<p>A screen script it is.  It will attach to the <code class="docutils literal notranslate"><span class="pre">OE1100</span></code> Order Entry
screen. On insert of a new detail line, it needs to:</p>
<ol class="arabic simple">
<li>Check if the operation was successful.</li>
<li>Check if the item matches “A1-103/0”.</li>
<li>Generate a new record in the view.</li>
<li>Populate the record with the Item “A1-105/0” Qty 1.</li>
<li>Save the record.</li>
</ol>
<div class="section" id="import-accpac-and-scaffold">
<h2>Import accpac and Scaffold<a class="headerlink" href="#import-accpac-and-scaffold" title="Permalink to this headline">¶</a></h2>
<p>All scripts start the same, import all members of <code class="docutils literal notranslate"><span class="pre">accpac.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">accpac</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Importing <code class="docutils literal notranslate"><span class="pre">*</span></code> is generally not a good idea, you don’t know what is being
pulled into the namespace.  You can import only the things you need, plus
some extras, with a little trial and error.</p>
</div>
<p>Because this is a screen script, we must create a new instance of the
<code class="docutils literal notranslate"><span class="pre">accpac.UI</span></code> class, initialize its parent, and tell it to <code class="docutils literal notranslate"><span class="pre">.show()</span></code> itself.
To get a custom UI or change going, create a subclass.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">accpac</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">OeAddLineUI</span><span class="p">(</span><span class="n">UI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A UI customization that monitors the order details for a trigger</span>
<span class="sd">    item being inserted and adds a new line.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ui</span> <span class="o">=</span> <span class="n">OeAddLineUI</span><span class="p">()</span>
</pre></div>
</div>
<p>When working with screens Extender exposes <code class="docutils literal notranslate"><span class="pre">accpac.UIDatasource</span></code> objects.
These act very similar to views. They allow access to the data sources
underlying the current screen.  Data sources are always composed with one
another, making coordinated access easy.</p>
<p>Datasources are opened using their unique <code class="docutils literal notranslate"><span class="pre">Module</span> <span class="pre">Name</span></code>. Module names
can be found using the RotoID for the program (O/E Order Entry in our case -
<code class="docutils literal notranslate"><span class="pre">OE1100</span></code>) and looking up the details in <code class="docutils literal notranslate"><span class="pre">accpacInfo</span></code>.</p>
<p>A little digging reveals that the datasource module id for Order Details is
<code class="docutils literal notranslate"><span class="pre">adsOEORDD</span></code>.  Open a datasource using <code class="docutils literal notranslate"><span class="pre">UI.openDataSource(module_id)</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">accpac</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">OeAddLineUI</span><span class="p">(</span><span class="n">UI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A UI customization that monitors the order details for a trigger</span>
<span class="sd">    item being inserted and adds a new line.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Open the data source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">openDataSource</span><span class="p">(</span><span class="s2">&quot;adsOEORDD&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ui</span> <span class="o">=</span> <span class="n">OeAddLineUI</span><span class="p">()</span>
</pre></div>
</div>
<p>Now we need to decide which events to listen to, do we need to check the record
before or after insert?  Before the operation occurs we can’t know whether it
was successful and it may fail.  If we were to act before a successful
operation we may create new lines when the triggering line failed.</p>
<p><code class="docutils literal notranslate"><span class="pre">onAfter</span></code> seems the correct choice.  Assign a call back function to the
<code class="docutils literal notranslate"><span class="pre">onAfterInsert</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">adsOEORDD</span></code> datasource.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">accpac</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">OeAddLineUI</span><span class="p">(</span><span class="n">UI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A UI customization that monitors the order details for a trigger</span>
<span class="sd">    item being inserted and adds a new line.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Open the data source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">openDataSource</span><span class="p">(</span><span class="s2">&quot;adsOEORDD&quot;</span><span class="p">)</span>

        <span class="c1"># Assign the onAfter callback to the *function*</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDD</span><span class="o">.</span><span class="n">onAfterInsert</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDDonAfterInsert</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">adsOEORDDonAfterInsert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;After updating, if the item is &quot;A1-103/0&quot;, insert a new line.&quot;&quot;&quot;</span>
        <span class="c1"># Check if the item matches</span>

        <span class="c1"># Generate a new record in the view</span>

        <span class="c1"># Populate the record</span>

        <span class="c1"># Save the record</span>
        <span class="k">pass</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ui</span> <span class="o">=</span> <span class="n">OeAddLineUI</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="implement-the-onafter-call">
<h2>Implement the onAfter call<a class="headerlink" href="#implement-the-onafter-call" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">accpac.UIDatasource.onAfterInsert</span></code> callback does not receive arguments
and is only triggered on a successful insert.  Now we need to see if the item
matches.  Use the <code class="docutils literal notranslate"><span class="pre">.get(field)</span></code> method on the datasource to get the current
value.  Field names can be found by looking them up using the Extender View
Info Inquiry or using the Sage <code class="docutils literal notranslate"><span class="pre">accpacViewInfo</span></code> utility.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">accpac</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">OeAddLineUI</span><span class="p">(</span><span class="n">UI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A UI customization that monitors the order details for a trigger</span>
<span class="sd">    item being inserted and adds a new line.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Open the data source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">openDataSource</span><span class="p">(</span><span class="s2">&quot;adsOEORDD&quot;</span><span class="p">)</span>

        <span class="c1"># Assign the onAfter callback to the *function*</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDD</span><span class="o">.</span><span class="n">onAfterInsert</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDDonAfterInsert</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">adsOEORDDonAfterInsert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;After updating, if the item is &quot;A1-103/0&quot;, insert a new line.&quot;&quot;&quot;</span>

        <span class="c1"># Check if the item matches</span>
        <span class="k">if</span> <span class="n">me</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ITEM&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;A1-103/0&quot;</span><span class="p">:</span>

        <span class="c1"># Generate a new record in the view</span>

        <span class="c1"># Populate the record</span>

        <span class="c1"># Save the record</span>
        <span class="k">pass</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ui</span> <span class="o">=</span> <span class="n">OeAddLineUI</span><span class="p">()</span>
</pre></div>
</div>
<p>Generating a new line is generally accomplished by running two operations on
the datasource.  The first, <code class="docutils literal notranslate"><span class="pre">.recordClear()</span></code> resets the state of the
datasource.  The second, <code class="docutils literal notranslate"><span class="pre">.recordGenerate()</span></code>, creates a new record in the
datasource. Both return 0 when successful.</p>
<p>What should happen if these operations fail?  There is always a silent option,
but then the user may be confused as to why the line doesn’t isn’t created when
they expect it to.</p>
<p>Extender provides a number of ways to notify.  The first is using the
<code class="docutils literal notranslate"><span class="pre">showMessage(str)</span></code>, <code class="docutils literal notranslate"><span class="pre">showWarning(str)</span></code>, <code class="docutils literal notranslate"><span class="pre">showError(str)</span></code> method.  These
put messages on the error stack for Sage to display. They may not be displayed
immediately, which can be helpful for situtations where errors may occur in
bulk (such as during an import).  They also provide levels and a familiar
interace.</p>
<p>The second is to use <code class="docutils literal notranslate"><span class="pre">showMessageBox(str)</span></code> which will pop up a dialog
immediately. This is generally a better option for things the user needs to
know now and for any debugging you need.  Show a message box to the user on
failure.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">accpac</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">OeAddLineUI</span><span class="p">(</span><span class="n">UI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A UI customization that monitors the order details for a trigger</span>
<span class="sd">    item being inserted and adds a new line.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Open the data source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">openDataSource</span><span class="p">(</span><span class="s2">&quot;adsOEORDD&quot;</span><span class="p">)</span>

        <span class="c1"># Assign the onAfter callback to the *function*</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDD</span><span class="o">.</span><span class="n">onAfterInsert</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDDonAfterInsert</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">adsOEORDDonAfterInsert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;After updating, if the item is &quot;A1-103/0&quot;, insert a new line.&quot;&quot;&quot;</span>

        <span class="c1"># Check if the item matches</span>
        <span class="k">if</span> <span class="n">me</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ITEM&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;A1-103/0&quot;</span><span class="p">:</span>

            <span class="c1"># Generate a new record in the view</span>
            <span class="n">rc</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">recordClear</span><span class="p">()</span>
            <span class="n">rg</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">recordGenerate</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">rc</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">rg</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">showMessageBox</span><span class="p">(</span><span class="s2">&quot;Failed to generate new line.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

            <span class="c1"># Populate the record</span>

            <span class="c1"># Save the record</span>
        <span class="k">pass</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ui</span> <span class="o">=</span> <span class="n">OeAddLineUI</span><span class="p">()</span>
</pre></div>
</div>
<p>Now we just need to populate the record and save it. Set fields in the
current record by using <code class="docutils literal notranslate"><span class="pre">.put(field,</span> <span class="pre">value)</span></code>.  Once populated,
use <code class="docutils literal notranslate"><span class="pre">.insert()</span></code> to add write it to the database.  These operations
also return 0 on success.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">accpac</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">OeAddLineUI</span><span class="p">(</span><span class="n">UI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A UI customization that monitors the order details for a trigger</span>
<span class="sd">    item being inserted and adds a new line.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Open the data source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">openDataSource</span><span class="p">(</span><span class="s2">&quot;adsOEORDD&quot;</span><span class="p">)</span>

        <span class="c1"># Assign the onAfter callback to the *function*</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDD</span><span class="o">.</span><span class="n">onAfterInsert</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adsOEORDDonAfterInsert</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">adsOEORDDonAfterInsert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;After updating, if the item is &quot;A1-103/0&quot;, insert a new line.&quot;&quot;&quot;</span>

        <span class="c1"># Check if the item matches</span>
        <span class="k">if</span> <span class="n">me</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ITEM&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;A1-103/0&quot;</span><span class="p">:</span>

            <span class="c1"># Generate a new record in the view</span>
            <span class="n">rc</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">recordClear</span><span class="p">()</span>
            <span class="n">rg</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">recordGenerate</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">rc</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">rg</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">showMessageBox</span><span class="p">(</span><span class="s2">&quot;Failed to generate new line.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

            <span class="c1"># Populate the record</span>
            <span class="n">pi</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s2">&quot;ITEM&quot;</span><span class="p">,</span> <span class="s2">&quot;A1-105/0&quot;</span><span class="p">)</span>
            <span class="n">pq</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s2">&quot;QTYORDERED&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">pi</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pq</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">showMessageBox</span><span class="p">(</span><span class="s2">&quot;Failed to put values in new line.&quot;</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="c1"># Save the record</span>
            <span class="n">sv</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">insert</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">sv</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">showMessageBox</span><span class="p">(</span><span class="s2">&quot;Failed to save new line.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ui</span> <span class="o">=</span> <span class="n">OeAddLineUI</span><span class="p">()</span>
</pre></div>
</div>
<p>And there you have it.  A view script that does exactly what we need.
Are there any improvements to be had?</p>
</div>
<div class="section" id="add-parameters">
<h2>Add Parameters<a class="headerlink" href="#add-parameters" title="Permalink to this headline">¶</a></h2>
<p>What if the customer wants to change the items?  Instead of “A1-103/0”
triggering they may want “A1-900/G” to be the trigger.  What if they wanted
to add a quantity of 5 instead of 1?  At present, they’d need to change the
script because the items and quantity are hard coded.</p>
<p>View scripts support up to 4 user provided parameters of up to 250 characters,
so 1000 characters of arguments to play with. They are exposed by <code class="docutils literal notranslate"><span class="pre">accpac</span></code> as
<code class="docutils literal notranslate"><span class="pre">Parameter1</span></code>, <code class="docutils literal notranslate"><span class="pre">Parameter2</span></code>, <code class="docutils literal notranslate"><span class="pre">Parameter3</span></code>, <code class="docutils literal notranslate"><span class="pre">Parameter4</span></code>.</p>
<p>Unfortunately, screens scripts do not allow user provided parameters.  We will
see another solution later, when we add custom tables.</p>
</div>
<div class="section" id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<p>Screen scripts must follow a specific naming convention and have a particular
structure.  The Roto ID of the screen being customized must be present in
one of the first two <code class="docutils literal notranslate"><span class="pre">.</span></code> delineated parts of the filename:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">OE1100.COMPANY.script_name.py</span></code>: good</li>
<li><code class="docutils literal notranslate"><span class="pre">COMPANY.OE1100.script_name.py</span></code>: good</li>
<li><code class="docutils literal notranslate"><span class="pre">COMPANY-script_name-OE1100.py</span></code>: bad</li>
</ul>
<p>The file must also start with a single line comment that includes the
Roto ID:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># OE1100</span>
<span class="c1"># ... The rest of my script.</span>
</pre></div>
</div>
<p>With the file named correctly and the comment in place, time for testing.  Fire
up your favourite database and install the script in the Extender -&gt; Setup -&gt;
Scripts screen.</p>
<p>There is no need to configure screen scripts, if they are installed whey will
be loaded when the screen is loaded.  It is best to restart the Sage desktop
after installing but before testing your customization.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="making_the_module.html" class="btn btn-neutral float-right" title="Making an Extender Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="building_the_view_script.html" class="btn btn-neutral float-left" title="Building the View Script" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019 2665093 Ontario Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>