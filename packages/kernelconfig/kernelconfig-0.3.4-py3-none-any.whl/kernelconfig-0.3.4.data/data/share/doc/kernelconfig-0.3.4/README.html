<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.15.2: http://docutils.sourceforge.net/" />
<title>kernelconfig</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="kernelconfig">
<h1 class="title">kernelconfig</h1>

<p>Generate custom Linux kernel configurations from curated sources.</p>
<p>(Note. kernelconfig is a port to python of a previously privately-only released
tool called genconfig. The latter, before it died a horrible death at 5400rpm
or so, had much more advanced features, but these will be re-introduced
progressively. Error handling is currently mostly taken care of by python, so,
although it won't send you off track, error messages may look a bit cryptic at
times. This too will be improved.)</p>
<div class="section" id="introduction">
<h1>Introduction</h1>
<p>TL;DR Compiling a kernel is easy, configuring it not so much. Unless you have
the time and skill to follow kernel development, it is best to leave that to a
team of specialists. But where to download up to date configurations? What to
do if you need to do the same changes over and over with each new version?
Enter kernelconfig. It will automatically download a base configuration
matching the kernel you want to compile from a curated source of your choice
(Debian, Ubuntu, Fedora, Liquorix, etc...), customize it with a number of
options which suit your taste and needs, apply macros to set a number of
options in a smart way, and more.</p>
<p>You can do that, for example, from within the kernel sources directory:</p>
<pre class="literal-block">
$ kernelconfig
</pre>
<p>and it will automatically generate the .config file for you, using the default
settings (see below). No questions asked.</p>
<p>If you are not in the kernel sources directory and these are located in
'/usr/src/linux-4.2':</p>
<pre class="literal-block">
$ kernelconfig -k /usr/src/linux-4.2
</pre>
<p>In case the curated source in your settings does not have a base configuration
for kernel version 4.2 but has one for version 4.1:</p>
<pre class="literal-block">
$ kernelconfig -k /usr/src/linux-4.2 -v 4.1
</pre>
<p>Expect to have to answer some questions if/when you run 'make oldconfig' before
compiling your kernel.</p>
<p>Finally, if you are going to cross-compile a kernel for arm:</p>
<pre class="literal-block">
$ kernelconfig --arch arm
</pre>
<p>Here is a simple example of a settings file:</p>
<pre class="literal-block">
[source]
ubuntu --lowlatency

[options]
disable MODULE_SIG
enable BLK_DEV_SD SATA_AHCI
enable BTRFS_FS
module EVBUG
</pre>
<p>This will automatically download a version-matching Ubuntu configuration with
low-latency options, disable verification of module signatures, build the SCSI
disk and SATA AHCI drivers into the kernel (i.e., not as modules) to be able to
boot without an initramfs, and also build the BTRFS driver into the kernel for
the same reason. Finally, we make sure EVBUG is compiled as a module to only
load it when necessary since it will pollute the system log. This will be done
consistently and automatically every time you will need to compile a new
kernel. All that with the comfort of a whole team of upstream developers
handling the grunt work for you. As Tom and Ray Magliozzi like(d) to say:
&quot;Pretty cute, huh?&quot;</p>
<p>If you are the kind of perverted individual who likes reading manuals, then
read on. If not, get used to being mocked.</p>
</div>
<div class="section" id="installing-kernelconfig">
<h1>Installing kernelconfig</h1>
<p>The best way is, if possible, to rely on your distribution's package manager.</p>
<p>You will need the following python 3 packages: docutils, lxml and version 4 or
later of BeautifulSoup. Depending on your distribution, these can also be
called python-beautifulsoup, python3-bs4, python-lxml, python3-lxml,
python3-docutils, etc... Make sure you only get python 3 packages as
kernelconfig is not compatible with python 2.</p>
<p>You can install from PyPI using pip. For example, as root:</p>
<pre class="literal-block">
$ pip3 install kernelconfig
</pre>
<p>The default settings file and examples will be installed into
'/etc/kernelconfig'.</p>
<p>Whether root or not, it is possible to make a user installation, like this:</p>
<pre class="literal-block">
$ pip3 install --user kernelconfig
</pre>
<p>In this case, the default settings file and examples will be installed into
'~/.config/kernelconfig'.</p>
</div>
<div class="section" id="optional-arguments">
<h1>Optional arguments</h1>
<blockquote>
<ul>
<li><p class="first">-h, --help</p>
<p>Show the help message and exit.</p>
</li>
<li><p class="first">-a ARCH, --arch ARCH</p>
<p>Force the kernel configuration architecture. ARCH is as returned by 'uname
-m'. Useful for cross-compiling.</p>
</li>
<li><p class="first">-k KERNEL, --kernel KERNEL</p>
<p>Path to the unpacked kernel sources directory. It can be absolute or
relative to the current working directory. The default is '.', the current
working directory.</p>
</li>
<li><p class="first">-s SETTINGS, --settings SETTINGS</p>
<p>Path to the settings file. It can be an absolute or user-expandable path to
an arbitrary file. If it is a relative path, then the file will be searched
for relatively to ~/.config/kernelconfig first and then /etc/kernelconfig.
Sub-directories relative to both these locations can be used. If a path
relative to the current working directory is desired, prefix it with './'.
The default is 'default', i.e., '~/.config/kernelconfig/default' if it
exists, or, failing that, '/etc/kernelconfig/default'.</p>
</li>
<li><p class="first">-v VERSION, --version VERSION</p>
<p>Force the kernel configuration version. Useful when there is no matching
major kernel version in the curated source.</p>
</li>
</ul>
</blockquote>
</div>
<div class="section" id="settings-syntax">
<h1>Settings syntax</h1>
<p>A comment line starts with a '#' as its first character.</p>
<p>Lines can be empty. There is no limit as to how many consecutive empty lines
there can be.</p>
<div class="section" id="source-section">
<h2>[source] section</h2>
<p>Lines other than the first non-empty and non-comment line will be discarded.</p>
<p>A source is the name of an executable in either '/usr/share/kernelconfig' or
'~/.local/share/kernelconfig', depending on the instalation being of the --user
type or not, possibly followed by a number of optional arguments. For example:</p>
<pre class="literal-block">
liquorix --pae
</pre>
<p>or:</p>
<pre class="literal-block">
ubuntu --lowlatency
</pre>
<p>See &quot;Curated sources&quot; below for a list of supported sources and optional
arguments.</p>
</div>
<div class="section" id="options-section">
<h2>[options] section</h2>
<p>A list of one action per line followed by one or more kernel options to perform
the action on. No indentation is allowed, but empty and comment lines are
possible.</p>
<p>Actions:</p>
<blockquote>
<ul>
<li><p class="first"><strong>enable</strong>: enable the option in the kernel, not as module.
For example:</p>
<pre class="literal-block">
enable BLK_SD_DEV SATA_AHCI
</pre>
<p>Build the BLK_SD_DEV and ATA_AHCI drivers into the kernel so that it is
bootable without the need for an initramfs.</p>
</li>
<li><p class="first"><strong>module</strong>: enable the option as module only so as to be able to only load
it when desired. For example:</p>
<pre class="literal-block">
module EVBUG
</pre>
<p>The EVBUG driver is available to load for debugging when necessary.</p>
</li>
<li><p class="first"><strong>disable</strong>: disable the option entirely. For example:</p>
<pre class="literal-block">
disable MODULE_SIG
</pre>
<p>Disable module signature verification.</p>
</li>
<li><p class="first"><strong>set</strong>: set an option to a given value. For example:</p>
<pre class="literal-block">
set DEFAULT_IOSCHED=&quot;bfq&quot;
</pre>
<p>Use Budget Fair Queueing as the default I/O scheduler.</p>
</li>
</ul>
</blockquote>
<p>Note 1. Do not prefix options names with 'CONFIG_'. kernelconfig takes care of
that for you.</p>
<p>Note 2. Option names will always be capitalized for you if you don't. It is
however easier to read a settings file whose options are capitalized.</p>
</div>
</div>
<div class="section" id="curated-sources">
<h1>Curated sources</h1>
<p>Here is a list of the currently supported curated sources. More will come.</p>
<div class="section" id="arch">
<h2>Arch</h2>
<blockquote>
<ul class="simple">
<li>Name in settings: arch</li>
<li>Supported architectures: x86_64</li>
</ul>
</blockquote>
</div>
<div class="section" id="liquorix">
<h2>Liquorix</h2>
<blockquote>
<ul class="simple">
<li>Name in settings: liquorix</li>
<li>Supported architectures: i386, i686, x86_64</li>
<li>Options:<ul>
<li>--pae: enable Physical Address Extension on processors supporting it to
extend physical address space 4GB (i386 and i686 only).</li>
</ul>
</li>
</ul>
</blockquote>
</div>
<div class="section" id="ubuntu">
<h2>Ubuntu</h2>
<blockquote>
<ul class="simple">
<li>Name in settings: ubuntu</li>
<li>Supported architectures: i386, i686, x86_64 (upstream supports more, will
come later)</li>
<li>Options:<ul>
<li>--lowlatency: enable low-latency timing and preemption options.</li>
</ul>
</li>
</ul>
</blockquote>
</div>
</div>
<div class="section" id="todo">
<h1>TODO</h1>
<blockquote>
<ul class="simple">
<li>Add better error checking and feedback</li>
<li>Add sources: defconfig, fedora, centos, debian, genkernel, etc...</li>
<li>Centralize functions necessary to multiple sources</li>
<li>Add macros, parameterized macros, conditional macros</li>
<li>Autodetect hardware</li>
<li>Integrate with genkernel</li>
</ul>
</blockquote>
</div>
<div class="section" id="author">
<h1>Author</h1>
<p>Please send comments, patches, flowers and insults to Denis Dupeyron &lt;<a class="reference external" href="mailto:calchan&#64;gentoo.org">calchan&#64;gentoo.org</a>&gt;</p>
</div>
</div>
</body>
</html>
